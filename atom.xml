<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>敲键盘的呼伦贝尔人</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://kennethyo.me/"/>
  <updated>2016-09-05T10:37:31.000Z</updated>
  <id>http://kennethyo.me/</id>
  
  <author>
    <name>鸿雁</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>自建私有 Maven 仓库</title>
    <link href="http://kennethyo.me/2016/09/01/untitled-1472722428873/"/>
    <id>http://kennethyo.me/2016/09/01/untitled-1472722428873/</id>
    <published>2016-09-01T09:33:48.000Z</published>
    <updated>2016-09-05T10:37:31.000Z</updated>
    
    <content type="html">&lt;p&gt;项目组从2015年上半年全面切换到 AndroidStudio 进行开发，随着这1年多业务逻辑和代码逻辑的增长，导致项目  LibraryModule 由最初的3个增长到如今的8个。&lt;/p&gt;
&lt;p&gt;代码量的增加必然导致编译的变慢，AndroidStudio 在编译项目时会先编译 LibraryModule 生成 aar 包，之后这些 aar 包会和 APPModule 进行集成编译，最终生成 APK。这个编译过程，第一次在5.0及以上手机安装，经常会出现6分钟以上的编译时间，5.0以下手机也有3分钟左右的编译时间，这些时间严重影响了工作效率！&lt;/p&gt;
&lt;p&gt;考虑到 LibraryModule 是长期不会修改的代码，如果发布成 aar 加入到项目里，就可以节省下每次 Module 编译的时间。&lt;/p&gt;
&lt;p&gt;如果能够像 compile 第三方 Library 那样引用我们的 Library ，岂不是又降低 Module 的耦合，又单独对 Library 增加了版本控制。第三方 Library  基本都是把 aar 发布到中央 Maven 对外提供引用，而我们的 Library 作为公司的商业项目，是不可能发布到中央 Maven 对外提供引用的，这就要求我们需要有自己的 Maven 服务。&lt;/p&gt;
&lt;p&gt;私有 Maven 还会产生另一个好处，就是代理中央 Maven 仓库。例如，我们新加入了一个第三方库，导致每个人的 IDE 都需要从中央 Maven pull 库，而中国 GFW 的存在，导致中央 Maven 极其不稳定，经常 time out ，有了代理 Maven，只要代理 maven pull 一次库，每个人就不必从中央 Maven pull库了。&lt;/p&gt;
&lt;p&gt;这里我们是用 Docker 作为容器，在里面搭建的 Sonatype Nexus 私有 Maven 仓库。使用 Docker 的好处是可以把环境独立出来不会和服务器其他服务产生冲突，卸载也简单。&lt;/p&gt;
&lt;h1 id=&quot;安装-Docker-并运行-Nexus&quot;&gt;&lt;a href=&quot;#安装-Docker-并运行-Nexus&quot; class=&quot;headerlink&quot; title=&quot;安装 Docker 并运行 Nexus&quot;&gt;&lt;/a&gt;安装 Docker 并运行 Nexus&lt;/h1&gt;&lt;p&gt;1，下载 并安装 Docker，&lt;a href=&quot;https://www.docker.com/products/docker#/mac&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2，在 Terminal 中输入&lt;code&gt;docker -v&lt;/code&gt;，如果显示版本号，说明安装后环境是没有问题的，如下是我显示的版本号：&lt;br&gt;&lt;code&gt;Docker version 1.12.0, build 8eab29e&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3，在 Terminal 输入&lt;code&gt;docker pull sonatype/nexus&lt;/code&gt;进行下载 nexus 镜像。&lt;br&gt;下载过程中，会显示下载进度。如果比较慢或者超时，请在 Docker 里设置 mirror。如下图，我配置了灵雀加速和阿里云加速。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/72f96cbajw1f7e4dnn8xcj20l40u60w6.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;br&gt;灵雀加速：&lt;a href=&quot;http://houchaohann.m.alauda.cn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://houchaohann.m.alauda.cn&lt;/a&gt;&lt;br&gt;阿里云加速：&lt;a href=&quot;https://3wky8dz8.mirror.aliyuncs.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://3wky8dz8.mirror.aliyuncs.com&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;下载成功后显示如下图：&lt;br&gt;&lt;img src=&quot;http://ww4.sinaimg.cn/large/72f96cbajw1f7e4gjbjvbj20g306kjs1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;4，在 Terminal 中输入&lt;code&gt;docker run -d -p 8081:8081 --name  yiche sonatype/nexus:oss&lt;/code&gt;来创建一个名叫 yiche 的容器，占用端口8081。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/72f96cbajw1f7e4kafrkcj20lw01bdg3.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;5，在 Terminal 中输入&lt;code&gt;docker ps -a&lt;/code&gt;查看容器&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/72f96cbajw1f7e4quvlv0j20q401sglu.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;6，浏览器里输入&lt;a href=&quot;http://localhost:8081/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://localhost:8081/&lt;/a&gt;，如果显示如下界面，证明 Nexus 搭建成功。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww4.sinaimg.cn/large/72f96cbajw1f7e4x3tmhej21kw0zkk21.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;7，一些常用指令：&lt;br&gt;&lt;code&gt;docker start yiche&lt;/code&gt;开始运行yiche 容器&lt;br&gt;&lt;code&gt;docker restart yiche&lt;/code&gt;c运 重新行yiche容器&lt;br&gt;&lt;code&gt;docker stop yiche&lt;/code&gt;停止运行yiche容器&lt;br&gt;&lt;code&gt;docker rm yiche&lt;/code&gt;删除yiche容器&lt;/p&gt;
&lt;h1 id=&quot;Nexus-使用&quot;&gt;&lt;a href=&quot;#Nexus-使用&quot; class=&quot;headerlink&quot; title=&quot;Nexus 使用&quot;&gt;&lt;/a&gt;Nexus 使用&lt;/h1&gt;&lt;p&gt;点击右上角&lt;code&gt;login&lt;/code&gt;登录，默认账户&lt;code&gt;admin&lt;/code&gt;，默认密码&lt;code&gt;admin123&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;点击左侧栏目的&lt;code&gt;Repositories&lt;/code&gt;，显示Nexus 默认已经有的仓库，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/72f96cbajw1f7e5tldqexj21kw0zkwrs.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;创建一个私有仓库&quot;&gt;&lt;a href=&quot;#创建一个私有仓库&quot; class=&quot;headerlink&quot; title=&quot;创建一个私有仓库&quot;&gt;&lt;/a&gt;创建一个私有仓库&lt;/h2&gt;&lt;p&gt;1，点击&lt;code&gt;add&lt;/code&gt;，选择&lt;code&gt;Hosted Repository&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2，在下方输入&lt;code&gt;Repository ID&lt;/code&gt;和&lt;code&gt;Repository Name&lt;/code&gt;，这里我分别输入的是&lt;code&gt;demo&lt;/code&gt;和&lt;code&gt;Demo&lt;/code&gt;，这里可以换成你自己的。&lt;/p&gt;
&lt;p&gt;3，部署策略&lt;code&gt;Deployment Policy&lt;/code&gt;选择为&lt;code&gt;Allow Redeploy&lt;/code&gt;允许重新部署。&lt;/p&gt;
&lt;p&gt;4，点击&lt;code&gt;save&lt;/code&gt;保存，在上方列表中就会显示完成的仓库信息，最后一列&lt;code&gt;Repository Path&lt;/code&gt;就是仓库的地址。&lt;/p&gt;
&lt;p&gt;如下图：&lt;br&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/72f96cbajw1f7e625xn92j21kw0zkdsb.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;注：如果在&lt;code&gt;Repository Policy&lt;/code&gt;选择&lt;code&gt;snapshot&lt;/code&gt;，仓库就是快照版仓库。&lt;/p&gt;
&lt;h2 id=&quot;代理仓库&quot;&gt;&lt;a href=&quot;#代理仓库&quot; class=&quot;headerlink&quot; title=&quot;代理仓库&quot;&gt;&lt;/a&gt;代理仓库&lt;/h2&gt;&lt;p&gt;这里我是代理的 jcenter，因为这是 Android  Studio 的默认仓库。&lt;/p&gt;
&lt;p&gt;1，点击&lt;code&gt;add&lt;/code&gt;，选择&lt;code&gt;Proxy Repository&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2，在下方输入&lt;code&gt;Repository ID&lt;/code&gt;和&lt;code&gt;Repository Name&lt;/code&gt;，这里我分别输入的是&lt;code&gt;jcenter&lt;/code&gt;和&lt;code&gt;Jcenter&lt;/code&gt;，因为代理的就是 jcenter 哈。&lt;/p&gt;
&lt;p&gt;3，在&lt;code&gt;Remote Storage Location&lt;/code&gt;输入代理仓库的仓库地址&lt;code&gt;http://jcenter.bintray.com/&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;4，点击&lt;code&gt;save&lt;/code&gt;保存，在上方列表中就会显示完成的仓库信息，最后一列&lt;code&gt;Repository Path&lt;/code&gt;就是仓库的地址。&lt;/p&gt;
&lt;p&gt;如下图：&lt;br&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/72f96cbajw1f7e6iqpczrj21kw0zktlr.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;其实在我们项目里并没有新创建一个仓库，而是直接用的默认&lt;code&gt;Release&lt;/code&gt;和&lt;code&gt;Snapshot&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://ww2.sinaimg.cn/large/72f96cbajw1f7e6n006u5j21ji02sgn0.jpg&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;Android-Studio-中上传-Library-Module-到私有-maven&quot;&gt;&lt;a href=&quot;#Android-Studio-中上传-Library-Module-到私有-maven&quot; class=&quot;headerlink&quot; title=&quot;Android Studio 中上传 Library Module 到私有 maven&quot;&gt;&lt;/a&gt;Android Studio 中上传 Library Module 到私有 maven&lt;/h1&gt;&lt;h2 id=&quot;上传到-Maven&quot;&gt;&lt;a href=&quot;#上传到-Maven&quot; class=&quot;headerlink&quot; title=&quot;上传到 Maven&quot;&gt;&lt;/a&gt;上传到 Maven&lt;/h2&gt;&lt;p&gt;因为，Module比较多，我在项目根目录里写了一个 gradle 文件&lt;code&gt;gradle_mvn_push.gradle&lt;/code&gt;来上传。代码如下：&lt;br&gt;&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apply &lt;span class=&quot;string&quot;&gt;plugin:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;maven&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//release 地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; RELEASE_REPOSITORY_URL = &lt;span class=&quot;string&quot;&gt;&quot;http://192.168.4.53:32770/content/repositories/releases/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//snapshots 地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; SNAPSHOT_REPOSITORY_URL = &lt;span class=&quot;string&quot;&gt;&quot;http://192.168.4.53:32770/content/repositories/snapshots/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//判断 VERSION_NAME 如果以`-SHAPSHOT`结尾,则上传地址为 snapshot 地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; REPOSITORY_URL = VERSION_NAME.endsWith(&lt;span class=&quot;string&quot;&gt;&quot;-SNAPSHOT&quot;&lt;/span&gt;) ? SNAPSHOT_REPOSITORY_URL : RELEASE_REPOSITORY_URL;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;logger.info(&lt;span class=&quot;string&quot;&gt;&quot;groupId = %s\t\nartifactId = %s\t\nversion = %s\t\nrepository = %s\t\n&quot;&lt;/span&gt;, GROUP, POM_ARTIFACT_ID, VERSION_NAME, REPOSITORY_URL)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;afterEvaluate &amp;#123; project -&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    uploadArchives &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        repositories.mavenDeployer &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            pom.groupId = GROUP&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            pom.artifactId = POM_ARTIFACT_ID&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            pom.version = VERSION_NAME&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            repository(&lt;span class=&quot;string&quot;&gt;url:&lt;/span&gt; REPOSITORY_URL) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                authentication(&lt;span class=&quot;string&quot;&gt;userName:&lt;/span&gt; NEXUS_USERNAME, &lt;span class=&quot;string&quot;&gt;password:&lt;/span&gt; NEXUS_PASSWORD)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    task androidSourcesJar(&lt;span class=&quot;string&quot;&gt;type:&lt;/span&gt; Jar) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        classifier = &lt;span class=&quot;string&quot;&gt;&#39;sources&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        from android.sourceSets.main.java.sourceFiles&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    artifacts &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        archives androidSourcesJar&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后在你要上传 module 的&lt;code&gt;build.gradle&lt;/code&gt; 文件引入。&lt;br&gt;如下图是我们换肤 Module 的 &lt;code&gt;build.gradle&lt;/code&gt;：&lt;br&gt;&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;apply &lt;span class=&quot;string&quot;&gt;plugin:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;com.android.library&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;android &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    compileSdkVersion Integer.valueOf(COMPILE_SDK_VERSION)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    buildToolsVersion BUILD_TOOLS_VERSION&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    defaultConfig &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        minSdkVersion MIN_SDK_VERSION&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        targetSdkVersion TARGET_SDK_VERSION&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        versionCode &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        versionName &lt;span class=&quot;string&quot;&gt;&quot;1.0&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    buildTypes &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        release &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            minifyEnabled &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            proguardFiles getDefaultProguardFile(&lt;span class=&quot;string&quot;&gt;&#39;proguard-android.txt&#39;&lt;/span&gt;), &lt;span class=&quot;string&quot;&gt;&#39;proguard-rules.pro&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    compile fileTree(&lt;span class=&quot;string&quot;&gt;dir:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;libs&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;include:&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;&#39;*.jar&#39;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    compile SUPPORT_APPCOMPAT_V7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    compile SUPPORT_CARDVIEW_V7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ext.GROUP=&lt;span class=&quot;string&quot;&gt;&quot;com.yiche&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ext.VERSION_NAME=&lt;span class=&quot;string&quot;&gt;&quot;1.1.0-SNAPSHOT&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ext.POM_ARTIFACT_ID=&lt;span class=&quot;string&quot;&gt;&quot;changeskin&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apply &lt;span class=&quot;string&quot;&gt;from:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;$&amp;#123;project.rootDir&amp;#125;/gradle_mvn_push.gradle&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里请关注下面的代码，&lt;code&gt;GROUP&lt;/code&gt;，&lt;code&gt;VERSION_NAME&lt;/code&gt;，&lt;code&gt;POM_ARTIFACT_ID&lt;/code&gt;和最后一行引入我们前面写的&lt;code&gt;gradle_mvn_push.gradle&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;GROUP&lt;/code&gt;一般代表了你的组织名称，例如我的&lt;code&gt;com.yiche&lt;/code&gt;&lt;br&gt;&lt;code&gt;POM_ARTIFACT_ID&lt;/code&gt;Library 的简称。&lt;br&gt;&lt;code&gt;VERSION_NAME&lt;/code&gt;版本号，如果有&lt;code&gt;-SNAPSHOT&lt;/code&gt;表示是快照版。&lt;/p&gt;
&lt;p&gt;上面这三个也就组成了我们平常看见的引依赖 &lt;code&gt;com.yiche:changeskin:1.1.0-SNAPSHOT&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;引用私有-Maven&quot;&gt;&lt;a href=&quot;#引用私有-Maven&quot; class=&quot;headerlink&quot; title=&quot;引用私有 Maven&quot;&gt;&lt;/a&gt;引用私有 Maven&lt;/h2&gt;&lt;p&gt;下面就直接上一段代码吧，这是项目根目录的&lt;code&gt;build.gradle&lt;/code&gt;里面修改了 maven 仓库的地址。&lt;/p&gt;
&lt;figure class=&quot;highlight groovy&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Top-level build file where you can add configuration options common to all sub-projects/modules.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;buildscript &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    repositories &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        jcenter()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dependencies &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        classpath &lt;span class=&quot;string&quot;&gt;&#39;com.android.tools.build:gradle:2.1.3&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;allprojects &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    repositories &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//        jcenter()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 私有 release 地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        maven&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            url &lt;span class=&quot;string&quot;&gt;&quot;http://192.168.4.53:32770/content/repositories/releases/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 私有 snapshot 地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        maven&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            url &lt;span class=&quot;string&quot;&gt;&quot;http://192.168.4.53:32770/content/repositories/snapshots/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//jcenter 代理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        maven&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            url &lt;span class=&quot;string&quot;&gt;&quot;http://192.168.4.53:32770/content/repositories/jcenter/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// maven 代理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        maven&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            url &lt;span class=&quot;string&quot;&gt;&quot;http://192.168.4.53:32770/content/repositories/central/&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;task clean(&lt;span class=&quot;string&quot;&gt;type:&lt;/span&gt; Delete) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    delete rootProject.buildDir&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;好的，到这里就算结束了，后面这部分写的比较少，有问题留言啦。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;项目组从2015年上半年全面切换到 AndroidStudio 进行开发，随着这1年多业务逻辑和代码逻辑的增长，导致项目  LibraryModule 由最初的3个增长到如今的8个。&lt;/p&gt;
&lt;p&gt;代码量的增加必然导致编译的变慢，AndroidStudio 在编译项目时会先
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
      <category term="Docker" scheme="http://kennethyo.me/categories/Android/Docker/"/>
    
    
      <category term="Nexus" scheme="http://kennethyo.me/tags/Nexus/"/>
    
      <category term="maven" scheme="http://kennethyo.me/tags/maven/"/>
    
      <category term="jcenter" scheme="http://kennethyo.me/tags/jcenter/"/>
    
      <category term="Docker" scheme="http://kennethyo.me/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>TextUtils方法介绍</title>
    <link href="http://kennethyo.me/2016/07/06/2016-07-06/"/>
    <id>http://kennethyo.me/2016/07/06/2016-07-06/</id>
    <published>2016-07-06T07:50:37.000Z</published>
    <updated>2016-09-01T06:36:36.000Z</updated>
    
    <content type="html">&lt;p&gt;把一个&lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;输出成&lt;code&gt;a,b,c&lt;/code&gt;这种形式，我们项目里面提供了一个这样的工具类：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static String getString(List&amp;lt;String&amp;gt; list) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (CollectionsWrapper.isEmpty(list)) return null;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        StringBuilder sb = new StringBuilder();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        int size = list.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for (int i = 0; i &amp;lt; size; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sb.append(list.get(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (i != size - 1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                sb.append(&amp;quot;,&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        return sb.toString();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;方法肯定是多种多样的，但是&lt;code&gt;Android SDK&lt;/code&gt;在&lt;code&gt;TextUtils&lt;/code&gt;里面就有提供了一个方法&lt;code&gt;join&lt;/code&gt;，可以达到效果。&lt;/p&gt;
&lt;p&gt;平常我开发用&lt;code&gt;TextUtils&lt;/code&gt;中最多的方法分别是&lt;code&gt;isEmpty&lt;/code&gt;和&lt;code&gt;equals&lt;/code&gt;。其他方法了解并不多，或者不了解，下面我们开始介绍一下&lt;code&gt;TextUtils&lt;/code&gt;中的方法（注：方法重载只介绍一种，隐藏和私有方法没有介绍）：&lt;/p&gt;
&lt;h1 id=&quot;初始化&quot;&gt;&lt;a href=&quot;#初始化&quot; class=&quot;headerlink&quot; title=&quot;初始化&quot;&gt;&lt;/a&gt;初始化&lt;/h1&gt;&lt;p&gt;Demo 地址：&lt;a href=&quot;https://github.com/KennethYo/TextUtilsDemo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;private String mWords1 = &amp;quot;这句话很长很长，真的很长很长，长的不得了，长的不要不要的，长...长长...chang...chang................&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;private String mWords2 = &amp;quot;Andy, Bob, Charles, David, Andy, Bob, Charles, David, Andy, Bob, Charles, David, Andy, Bob, Charles, David, Andy, Bob, Charles, David&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//把“很长”设置为红色背景&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mSpanny1 = new Spanny(mWords1).findAndSpan(&amp;quot;很长&amp;quot;, new Spanny.GetSpan() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            @Override&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            public Object getSpan() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                return new BackgroundColorSpan(Color.RED);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//把“Bob”设置为红色背景&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mSpanny2 = new Spanny(mWords2).findAndSpan(&amp;quot;Bob&amp;quot;, new Spanny.GetSpan() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            @Override&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            public Object getSpan() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                return new BackgroundColorSpan(Color.GREEN);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;commaEllipsize&quot;&gt;&lt;a href=&quot;#commaEllipsize&quot; class=&quot;headerlink&quot; title=&quot;commaEllipsize&quot;&gt;&lt;/a&gt;commaEllipsize&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence commaEllipsize(CharSequence text,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                              TextPaint p, float avail,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                              String oneMore,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                              String more)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;例如&lt;code&gt;Andy, Bob, Charles, David&lt;/code&gt;这样的句子，修改为能够在一行&lt;code&gt;avail&lt;/code&gt;宽度显示。发回结果例如&lt;br&gt;&lt;code&gt;Andy, Bob, 1 more&lt;/code&gt;或&lt;code&gt;Andy, Bob, 2 more&lt;/code&gt;。&lt;br&gt;注意：more 中的数字要有&lt;code&gt;%d&lt;/code&gt;来format，来显示不同的数字。&lt;code&gt;text&lt;/code&gt;中必须用英文逗号分隔。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CharSequence output = TextUtils.commaEllipsize(mWords2, mTextView.getPaint(), mScreenWidth, &amp;quot;1 more&amp;quot;, &amp;quot;%d more&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;concat&quot;&gt;&lt;a href=&quot;#concat&quot; class=&quot;headerlink&quot; title=&quot;concat&quot;&gt;&lt;/a&gt;concat&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence concat(CharSequence... text)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;text 为可变参数，可以将传入的&lt;code&gt;CharSequence&lt;/code&gt;组成一个&lt;code&gt;CharSequence&lt;/code&gt;，并保留原有的&lt;code&gt;Span&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CharSequence charSequence = TextUtils.concat(mSpanny1, mSpanny2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(charSequence);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;copySpansFrom&quot;&gt;&lt;a href=&quot;#copySpansFrom&quot; class=&quot;headerlink&quot; title=&quot;copySpansFrom&quot;&gt;&lt;/a&gt;copySpansFrom&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static void copySpansFrom(Spanned source, int start, int end,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                     Class kind,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                     Spannable dest, int destoff)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从&lt;code&gt;source&lt;/code&gt;中&lt;code&gt;start&lt;/code&gt;到&lt;code&gt;end&lt;/code&gt; 中的&lt;code&gt;span&lt;/code&gt;复制到&lt;code&gt;dest&lt;/code&gt;中，&lt;code&gt;destoff&lt;/code&gt;是偏移量。这个方法在&lt;code&gt;concat&lt;/code&gt;中有用到。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;String words = mWords1 + mWords2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(words);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(mSpanny2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SpannableString ss = new SpannableString(words);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;TextUtils.copySpansFrom(mSpanny2, 0, mSpanny2.length(), Object.class, ss, mWords1.length());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(ss);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;dumpSpans&quot;&gt;&lt;a href=&quot;#dumpSpans&quot; class=&quot;headerlink&quot; title=&quot;dumpSpans&quot;&gt;&lt;/a&gt;dumpSpans&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static void dumpSpans(CharSequence cs, Printer printer, String prefix)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;打印&lt;code&gt;cs&lt;/code&gt;中的&lt;code&gt;Span&lt;/code&gt;，&lt;code&gt;prefix&lt;/code&gt;会在打印每个&lt;code&gt;Span&lt;/code&gt;开始出现。&lt;code&gt;printer&lt;/code&gt;，可以用&lt;code&gt;LogPrinter&lt;/code&gt;，这样就可以打印在 log 里。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;TextUtils.dumpSpans(mSpanny1, new LogPrinter(Log.INFO, &amp;quot;kenneth&amp;quot;), &amp;quot;yo&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Log日志&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;07-01 14:53:20.229 9835-9835/me.kenneth.textutildemo I/kenneth: yo很长: 4189d0d0 android.text.style.BackgroundColorSpan (3-5) fl=#33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;07-01 14:53:20.229 9835-9835/me.kenneth.textutildemo I/kenneth: yo很长: 4189d3a8 android.text.style.BackgroundColorSpan (5-7) fl=#33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;07-01 14:53:20.229 9835-9835/me.kenneth.textutildemo I/kenneth: yo很长: 4189d5b8 android.text.style.BackgroundColorSpan (10-12) fl=#33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;07-01 14:53:20.230 9835-9835/me.kenneth.textutildemo I/kenneth: yo很长: 4189d728 android.text.style.BackgroundColorSpan (12-14) fl=#33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;ellipsize&quot;&gt;&lt;a href=&quot;#ellipsize&quot; class=&quot;headerlink&quot; title=&quot;ellipsize&quot;&gt;&lt;/a&gt;ellipsize&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence ellipsize(CharSequence text,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                         TextPaint paint,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                         float avail, TruncateAt where,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                         boolean preserveLength,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                         EllipsizeCallback callback)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;相当于 &lt;code&gt;TextView&lt;/code&gt; 的 xml 中&lt;code&gt;ellipsize&lt;/code&gt;，这里可以回调省略范围的 &lt;code&gt;index&lt;/code&gt;，同时也可用通过&lt;code&gt;preserveLength&lt;/code&gt;，设置返回的 &lt;code&gt;CharSequence&lt;/code&gt; 的长度为原始长度还是省略后的长度，这里利用的”零宽不换行空格符”来占位，&lt;code&gt;where&lt;/code&gt;参数可以用&lt;code&gt;TextUtils.TruncateAt.START&lt;/code&gt;，&lt;code&gt;TextUtils.TruncateAt.END&lt;/code&gt;，&lt;code&gt;TextUtils.TruncateAt.MIDDLE&lt;/code&gt;和&lt;code&gt;TextUtils.TruncateAt.MARQUEE&lt;/code&gt;，分别是开始，结尾，中间和跑马灯。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CharSequence ellipsize = TextUtils.ellipsize(mWords2, mTextView.getPaint(), mScreenWidth, TextUtils.TruncateAt.START, true, new TextUtils.EllipsizeCallback() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    @Override&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    public void ellipsized(int i, int i1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        Log.i(TAG, &amp;quot;被省略范围 &amp;quot; + i + &amp;quot; &amp;quot; + i1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;equals&quot;&gt;&lt;a href=&quot;#equals&quot; class=&quot;headerlink&quot; title=&quot;equals&quot;&gt;&lt;/a&gt;equals&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static boolean equals(CharSequence a, CharSequence b)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;比较字符串是否相等，可以看一下源码，如果是相同文本内容，但是&lt;code&gt;span&lt;/code&gt;不同，也可以比较为相同。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;TextUtils.equals(mWords1, mSpanny1)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;expandTemplate&quot;&gt;&lt;a href=&quot;#expandTemplate&quot; class=&quot;headerlink&quot; title=&quot;expandTemplate&quot;&gt;&lt;/a&gt;expandTemplate&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence expandTemplate(CharSequence template,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                              CharSequence... values)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;替换&lt;code&gt;template&lt;/code&gt;当中的&lt;code&gt;^1`` ^2&lt;/code&gt; 等为&lt;code&gt;values&lt;/code&gt;中相应的值，注意：不能超过9个，9个以上会抛出异常。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;String template = &amp;quot;This is a ^1 of the ^2 broadcast ^3.&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mTextView.setText(template);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                CharSequence expandTemplate = TextUtils.expandTemplate(template, &amp;quot;test&amp;quot;, &amp;quot;emergency&amp;quot;, &amp;quot;system&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;getCapsMode&quot;&gt;&lt;a href=&quot;#getCapsMode&quot; class=&quot;headerlink&quot; title=&quot;getCapsMode&quot;&gt;&lt;/a&gt;getCapsMode&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int getCapsMode(CharSequence cs, int off, int reqModes)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个方法不知道怎么用，求留言赐教。&lt;/p&gt;
&lt;h1 id=&quot;getChars&quot;&gt;&lt;a href=&quot;#getChars&quot; class=&quot;headerlink&quot; title=&quot;getChars&quot;&gt;&lt;/a&gt;getChars&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static void getChars(CharSequence s, int start, int end,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                char[] dest, int destoff)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分别各自调用 &lt;code&gt;CharSequence&lt;/code&gt;的 &lt;code&gt;getChars&lt;/code&gt;实现。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;char[] buffer = new char[5];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                TextUtils.getChars(mWords1, 2, 4, buffer, 0);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;getLayoutDirectionFromLocale&quot;&gt;&lt;a href=&quot;#getLayoutDirectionFromLocale&quot; class=&quot;headerlink&quot; title=&quot;getLayoutDirectionFromLocale&quot;&gt;&lt;/a&gt;getLayoutDirectionFromLocale&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int getLayoutDirectionFromLocale(Locale locale)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;根据传入的 &lt;code&gt;local&lt;/code&gt;获取当前的阅读习惯（例如，汉语习惯是左到右，希伯来语是右到左），具体可以看这篇文章，&lt;a href=&quot;http://droidyue.com/blog/2014/07/07/support-rtl-in-android/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://droidyue.com/blog/2014/07/07/support-rtl-in-android/index.html&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;getOffsetAfter&quot;&gt;&lt;a href=&quot;#getOffsetAfter&quot; class=&quot;headerlink&quot; title=&quot;getOffsetAfter&quot;&gt;&lt;/a&gt;getOffsetAfter&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int getOffsetAfter(CharSequence text, int offset)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取文本之后的偏移量 结合方法里的内容看比较容易,方法里面的&lt;code&gt;Unicode&lt;/code&gt;都是我们所谓的非法字符。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mWords1 = mWords1.replace(&amp;quot;很&amp;quot;, &amp;quot;\uD800&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mWords1 = mWords1.replace(&amp;quot;长&amp;quot;, &amp;quot;\uDFFF&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int offsetAfter = TextUtils.getOffsetAfter(mWords1, 5);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(String.valueOf(offsetAfter));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.append(mWords1.substring(offsetAfter));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;getOffsetBefore&quot;&gt;&lt;a href=&quot;#getOffsetBefore&quot; class=&quot;headerlink&quot; title=&quot;getOffsetBefore&quot;&gt;&lt;/a&gt;getOffsetBefore&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int getOffsetBefore(CharSequence text, int offset)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取文本之前的偏移量 结合方法里的内容看比较容易,方法里面的&lt;code&gt;Unicode&lt;/code&gt;都是我们所谓的非法字符。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mWords1 = mWords1.replace(&amp;quot;句&amp;quot;, &amp;quot;\uD800&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mWords1 = mWords1.replace(&amp;quot;话&amp;quot;, &amp;quot;\uDFFF&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int offsetBefore = TextUtils.getOffsetBefore(mWords1, 5);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(String.valueOf(offsetBefore));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.append(mWords1.substring(offsetBefore));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;getReverse&quot;&gt;&lt;a href=&quot;#getReverse&quot; class=&quot;headerlink&quot; title=&quot;getReverse&quot;&gt;&lt;/a&gt;getReverse&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence getReverse(CharSequence source,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                          int start, int end)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;翻转&lt;code&gt;start&lt;/code&gt;到&lt;code&gt;end&lt;/code&gt;的字符串。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;CharSequence reverse = TextUtils.getReverse(mWords1, 0, mWords1.length());&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;getTrimmedLength&quot;&gt;&lt;a href=&quot;#getTrimmedLength&quot; class=&quot;headerlink&quot; title=&quot;getTrimmedLength&quot;&gt;&lt;/a&gt;getTrimmedLength&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int getTrimmedLength(CharSequence s)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;trim 后的字符串长度。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mWords1 = &amp;quot; &amp;quot; + mWords1 + &amp;quot; &amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mTextView.append(String.valueOf(mWords1.length()));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int trimmedLength = TextUtils.getTrimmedLength(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(String.valueOf(trimmedLength));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;htmlEncode&quot;&gt;&lt;a href=&quot;#htmlEncode&quot; class=&quot;headerlink&quot; title=&quot;htmlEncode&quot;&gt;&lt;/a&gt;htmlEncode&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static String htmlEncode(String s)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;encode html ，注意是 html 。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;String code = &amp;quot;&amp;lt;h1&amp;gt;html&amp;lt;/h1&amp;gt; &amp;quot; + mWords1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mTextView.setText(code);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(TextUtils.htmlEncode(code));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;indexOf&quot;&gt;&lt;a href=&quot;#indexOf&quot; class=&quot;headerlink&quot; title=&quot;indexOf&quot;&gt;&lt;/a&gt;indexOf&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int indexOf(CharSequence s, CharSequence needle,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                              int start, int end)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;获取&lt;code&gt;needle&lt;/code&gt;字符的 index。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;int indexOf = TextUtils.indexOf(mWords1, &amp;quot;不要的&amp;quot;, 0, mWords1.length());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(String.valueOf(indexOf));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.append(mWords1.substring(indexOf));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;isDigitsOnly&quot;&gt;&lt;a href=&quot;#isDigitsOnly&quot; class=&quot;headerlink&quot; title=&quot;isDigitsOnly&quot;&gt;&lt;/a&gt;isDigitsOnly&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static boolean isDigitsOnly(CharSequence str)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;判断是否仅有数字。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;String digits = &amp;quot;1234&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(digits);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;String digits1 = &amp;quot;123w123&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.append(digits1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;boolean digitsOnly = TextUtils.isDigitsOnly(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;boolean digitsOnly1 = TextUtils.isDigitsOnly(digits);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;boolean digitsOnly2 = TextUtils.isDigitsOnly(digits1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.setText(String.valueOf(digitsOnly));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.append(String.valueOf(digitsOnly1));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.append(&amp;quot;\n\n&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mOutputView.append(String.valueOf(digitsOnly2));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;isEmpty&quot;&gt;&lt;a href=&quot;#isEmpty&quot; class=&quot;headerlink&quot; title=&quot;isEmpty&quot;&gt;&lt;/a&gt;isEmpty&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static boolean isEmpty(CharSequence str)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;判空，这个太常用了。&lt;/p&gt;
&lt;h1 id=&quot;isGraphic&quot;&gt;&lt;a href=&quot;#isGraphic&quot; class=&quot;headerlink&quot; title=&quot;isGraphic&quot;&gt;&lt;/a&gt;isGraphic&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static boolean isGraphic(CharSequence str)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;判断是否有可以显示出来的字符。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;String graphic = &amp;quot;\n \t \b&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(graphic);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            mOutputView.setText(String.valueOf(TextUtils.isGraphic(graphic)));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;join&quot;&gt;&lt;a href=&quot;#join&quot; class=&quot;headerlink&quot; title=&quot;join&quot;&gt;&lt;/a&gt;join&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static String join(CharSequence delimiter, Iterable tokens)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;连接数组，例如：a b c d 输出 a-b-c-d，这个方法的重载支持了很多类型。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;String&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list.add(&amp;quot;a&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list.add(&amp;quot;b&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list.add(&amp;quot;c&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;list.add(&amp;quot;d&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(list.toString());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(TextUtils.join(&amp;quot;-&amp;quot;, list));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;lastIndexOf&quot;&gt;&lt;a href=&quot;#lastIndexOf&quot; class=&quot;headerlink&quot; title=&quot;lastIndexOf&quot;&gt;&lt;/a&gt;lastIndexOf&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static int lastIndexOf(CharSequence s, char ch)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;字符&lt;code&gt;ch&lt;/code&gt;最后一次出现的&lt;code&gt;index&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(mWords1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int c = TextUtils.lastIndexOf(mWords1, &amp;apos;c&amp;apos;);               mOutputView.setText(String.valueOf(c));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.append(&amp;quot;\n\n&amp;quot;);                mOutputView.append(mWords1.substring(c));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;regionMatches&quot;&gt;&lt;a href=&quot;#regionMatches&quot; class=&quot;headerlink&quot; title=&quot;regionMatches&quot;&gt;&lt;/a&gt;regionMatches&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static boolean regionMatches(CharSequence one, int toffset,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                        CharSequence two, int ooffset,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                        int len) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;比对两个字符串 &lt;code&gt;offset&lt;/code&gt;到 &lt;code&gt;len&lt;/code&gt; 的长度的字符串是否相同。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(TextUtils.replace(mWords1,new String[]&amp;#123;&amp;quot;很长&amp;quot;,&amp;quot;的&amp;quot;,&amp;quot;.&amp;quot;&amp;#125;,new String[]&amp;#123;&amp;quot;very long&amp;quot;,&amp;quot;of&amp;quot;,&amp;quot;。&amp;quot;&amp;#125;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;replace&quot;&gt;&lt;a href=&quot;#replace&quot; class=&quot;headerlink&quot; title=&quot;replace&quot;&gt;&lt;/a&gt;replace&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence replace(CharSequence template,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                       String[] sources,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                       CharSequence[] destinations)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;替换功能，注意：只会替换第一个出现的。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(TextUtils.replace(mWords1,new String[]&amp;#123;&amp;quot;很长&amp;quot;,&amp;quot;的&amp;quot;,&amp;quot;.&amp;quot;&amp;#125;,new String[]&amp;#123;&amp;quot;very long&amp;quot;,&amp;quot;of&amp;quot;,&amp;quot;。&amp;quot;&amp;#125;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;split&quot;&gt;&lt;a href=&quot;#split&quot; class=&quot;headerlink&quot; title=&quot;split&quot;&gt;&lt;/a&gt;split&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static String[] split(String text, String expression)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分割字符串。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(TextUtils.join(&amp;quot;--&amp;quot;,TextUtils.split(mWords2,&amp;quot;,&amp;quot;)));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;stringOrSpannedString&quot;&gt;&lt;a href=&quot;#stringOrSpannedString&quot; class=&quot;headerlink&quot; title=&quot;stringOrSpannedString&quot;&gt;&lt;/a&gt;stringOrSpannedString&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static CharSequence stringOrSpannedString(CharSequence source)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果是 &lt;code&gt;String&lt;/code&gt; 返回 &lt;code&gt;String&lt;/code&gt; ，&lt;code&gt;spannedString&lt;/code&gt; 或 &lt;code&gt;spanned&lt;/code&gt; 返回 &lt;code&gt;spannedString&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;例子:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(TextUtils.stringOrSpannedString(mSpanny1));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;substring&quot;&gt;&lt;a href=&quot;#substring&quot; class=&quot;headerlink&quot; title=&quot;substring&quot;&gt;&lt;/a&gt;substring&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static String substring(CharSequence source, int start, int end)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分割字符串。&lt;/p&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mOutputView.setText(TextUtils.substring(mSpanny1,2,16));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;writeToParcel&quot;&gt;&lt;a href=&quot;#writeToParcel&quot; class=&quot;headerlink&quot; title=&quot;writeToParcel&quot;&gt;&lt;/a&gt;writeToParcel&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public static void writeToParcel(CharSequence cs, Parcel p,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            int parcelableFlags)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;例子：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mTextView.setText(&amp;quot;一般用作序列化 CharSequence 子类&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;把一个&lt;code&gt;List&amp;lt;String&amp;gt;&lt;/code&gt;输出成&lt;code&gt;a,b,c&lt;/code&gt;这种形式，我们项目里面提供了一个这样的工具类：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="Utils" scheme="http://kennethyo.me/tags/Utils/"/>
    
      <category term="TextView" scheme="http://kennethyo.me/tags/TextView/"/>
    
      <category term="EditText" scheme="http://kennethyo.me/tags/EditText/"/>
    
      <category term="TextUtils" scheme="http://kennethyo.me/tags/TextUtils/"/>
    
  </entry>
  
  <entry>
    <title>Mac 下反编译 apk</title>
    <link href="http://kennethyo.me/2016/06/21/2016-06-21/"/>
    <id>http://kennethyo.me/2016/06/21/2016-06-21/</id>
    <published>2016-06-21T03:34:24.000Z</published>
    <updated>2016-09-01T06:36:58.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;1，环境准备&quot;&gt;&lt;a href=&quot;#1，环境准备&quot; class=&quot;headerlink&quot; title=&quot;1，环境准备&quot;&gt;&lt;/a&gt;1，环境准备&lt;/h1&gt;&lt;p&gt;&lt;code&gt;brew install apktool&lt;/code&gt;&lt;br&gt;&lt;code&gt;brew install dex2jar&lt;/code&gt;&lt;br&gt;&lt;code&gt;jd-gui&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;2，反编译-代码&quot;&gt;&lt;a href=&quot;#2，反编译-代码&quot; class=&quot;headerlink&quot; title=&quot;2，反编译 代码&quot;&gt;&lt;/a&gt;2，反编译 代码&lt;/h1&gt;&lt;p&gt;解压 apk 拿到 dex 文件&lt;br&gt;执行 &lt;code&gt;d2j-dex2jar classes.dex&lt;/code&gt; 获取到 jar 文件，拖进 jd-gui 就可以了&lt;/p&gt;
&lt;h1 id=&quot;3，反编译资源文件&quot;&gt;&lt;a href=&quot;#3，反编译资源文件&quot; class=&quot;headerlink&quot; title=&quot;3，反编译资源文件&quot;&gt;&lt;/a&gt;3，反编译资源文件&lt;/h1&gt;&lt;p&gt;执行 &lt;code&gt;apktool  d *.apk&lt;/code&gt;&lt;br&gt;-f  如果目标文件存在，删除存在&lt;br&gt;-o 指定目标文件夹名字&lt;br&gt;-s 不反编译 dex 文件&lt;br&gt;-r 不反编译资源文件&lt;/p&gt;
&lt;h1 id=&quot;4，重新打包&quot;&gt;&lt;a href=&quot;#4，重新打包&quot; class=&quot;headerlink&quot; title=&quot;4，重新打包&quot;&gt;&lt;/a&gt;4，重新打包&lt;/h1&gt;&lt;p&gt;&lt;code&gt;apktool b *.apk -o new.apk&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;5，签名-需要-java-环境变量&quot;&gt;&lt;a href=&quot;#5，签名-需要-java-环境变量&quot; class=&quot;headerlink&quot; title=&quot;5，签名(需要 java 环境变量)&quot;&gt;&lt;/a&gt;5，签名(需要 java 环境变量)&lt;/h1&gt;&lt;p&gt;&lt;code&gt;jarsigner  -verbose   -sigalg SHA1withRSA -digestalg SHA1 -keystore 签名文件 -storepass 签名密码 待签名 apk 签名的别名&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;6，对齐操作（程序运行的更快）&quot;&gt;&lt;a href=&quot;#6，对齐操作（程序运行的更快）&quot; class=&quot;headerlink&quot; title=&quot;6，对齐操作（程序运行的更快）&quot;&gt;&lt;/a&gt;6，对齐操作（程序运行的更快）&lt;/h1&gt;&lt;p&gt;&lt;code&gt;zipalign 4 *.apk *_aligned.apk&lt;/code&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1，环境准备&quot;&gt;&lt;a href=&quot;#1，环境准备&quot; class=&quot;headerlink&quot; title=&quot;1，环境准备&quot;&gt;&lt;/a&gt;1，环境准备&lt;/h1&gt;&lt;p&gt;&lt;code&gt;brew install apktool&lt;/code&gt;&lt;br&gt;&lt;code&gt;brew instal
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="反编译" scheme="http://kennethyo.me/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    
      <category term="brew" scheme="http://kennethyo.me/tags/brew/"/>
    
  </entry>
  
  <entry>
    <title>CURL常用指令</title>
    <link href="http://kennethyo.me/2016/06/17/2016-06-17/"/>
    <id>http://kennethyo.me/2016/06/17/2016-06-17/</id>
    <published>2016-06-17T03:48:12.000Z</published>
    <updated>2016-09-01T06:37:11.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;一，查看网页源代码&quot;&gt;&lt;a href=&quot;#一，查看网页源代码&quot; class=&quot;headerlink&quot; title=&quot;一，查看网页源代码&quot;&gt;&lt;/a&gt;一，查看网页源代码&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl www.bitauto.com&lt;/code&gt;&lt;br&gt;保存网页&lt;br&gt;&lt;code&gt;curl -o demo.txt www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;二，自动跳转&quot;&gt;&lt;a href=&quot;#二，自动跳转&quot; class=&quot;headerlink&quot; title=&quot;二，自动跳转&quot;&gt;&lt;/a&gt;二，自动跳转&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl -L www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;三，显示头信息&quot;&gt;&lt;a href=&quot;#三，显示头信息&quot; class=&quot;headerlink&quot; title=&quot;三，显示头信息&quot;&gt;&lt;/a&gt;三，显示头信息&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl -i www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;四，显示通信过程&quot;&gt;&lt;a href=&quot;#四，显示通信过程&quot; class=&quot;headerlink&quot; title=&quot;四，显示通信过程&quot;&gt;&lt;/a&gt;四，显示通信过程&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl -v www.bitauto.com&lt;/code&gt;&lt;br&gt;更多详细信息&lt;br&gt;&lt;code&gt;curl --trace demo.txt www.bitauto.com&lt;/code&gt;&lt;br&gt;&lt;code&gt;curl --trace--ascii demo.txt www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;五，发送表单信息&quot;&gt;&lt;a href=&quot;#五，发送表单信息&quot; class=&quot;headerlink&quot; title=&quot;五，发送表单信息&quot;&gt;&lt;/a&gt;五，发送表单信息&lt;/h1&gt;&lt;p&gt;GET&lt;br&gt;&lt;code&gt;curl www.bitauto.com/?data=xxx&lt;/code&gt;&lt;br&gt;POST&lt;br&gt;&lt;code&gt;curl -X POST --data &amp;quot;data=xxx&amp;quot; www.bitauto.com&lt;/code&gt;&lt;br&gt;&lt;code&gt;curl -X POST --data-urlencode &amp;quot;data=hello world&amp;quot; www.bitauto.com&lt;/code&gt;&lt;br&gt;DELETE&lt;br&gt;&lt;code&gt;curl -X DELETE www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;六，上传文件&quot;&gt;&lt;a href=&quot;#六，上传文件&quot; class=&quot;headerlink&quot; title=&quot;六，上传文件&quot;&gt;&lt;/a&gt;六，上传文件&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl --form uplaod=@demo.txt --form press=OK www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;七，Referer-字段&quot;&gt;&lt;a href=&quot;#七，Referer-字段&quot; class=&quot;headerlink&quot; title=&quot;七，Referer 字段&quot;&gt;&lt;/a&gt;七，Referer 字段&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl --referer www.bitauto.com www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;九，User-Agent-字段&quot;&gt;&lt;a href=&quot;#九，User-Agent-字段&quot; class=&quot;headerlink&quot; title=&quot;九，User Agent 字段&quot;&gt;&lt;/a&gt;九，User Agent 字段&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl --user-agent &amp;quot;user-agent&amp;quot; www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;十，Cookie&quot;&gt;&lt;a href=&quot;#十，Cookie&quot; class=&quot;headerlink&quot; title=&quot;十，Cookie&quot;&gt;&lt;/a&gt;十，Cookie&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl --cookie  &amp;quot;name=demo&amp;quot; www.bitauto.com&lt;/code&gt;&lt;br&gt;保存 cookie 到文件夹&lt;br&gt;&lt;code&gt;curl -c filename www.bitauto.com&lt;/code&gt;&lt;br&gt;使用文件的 cookie&lt;br&gt;&lt;code&gt;curl -b filename www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;十一，增加头信息&quot;&gt;&lt;a href=&quot;#十一，增加头信息&quot; class=&quot;headerlink&quot; title=&quot;十一，增加头信息&quot;&gt;&lt;/a&gt;十一，增加头信息&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl --header &amp;quot;Content-Type:application/json&amp;quot; www.bitauto.com&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;十二，HTTP-认证&quot;&gt;&lt;a href=&quot;#十二，HTTP-认证&quot; class=&quot;headerlink&quot; title=&quot;十二，HTTP 认证&quot;&gt;&lt;/a&gt;十二，HTTP 认证&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl --user name:password www.bitauto.com&lt;/code&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;一，查看网页源代码&quot;&gt;&lt;a href=&quot;#一，查看网页源代码&quot; class=&quot;headerlink&quot; title=&quot;一，查看网页源代码&quot;&gt;&lt;/a&gt;一，查看网页源代码&lt;/h1&gt;&lt;p&gt;&lt;code&gt;curl www.bitauto.com&lt;/code&gt;&lt;br&gt;保存网页&lt;
    
    </summary>
    
      <category term="Web" scheme="http://kennethyo.me/categories/Web/"/>
    
    
      <category term="Web" scheme="http://kennethyo.me/tags/Web/"/>
    
      <category term="CURL" scheme="http://kennethyo.me/tags/CURL/"/>
    
  </entry>
  
  <entry>
    <title>[原]React-Native Android 学习笔记——2，自定义 logger</title>
    <link href="http://kennethyo.me/2016/03/23/2016-03-23/"/>
    <id>http://kennethyo.me/2016/03/23/2016-03-23/</id>
    <published>2016-03-23T08:35:48.000Z</published>
    <updated>2016-09-01T06:37:33.000Z</updated>
    
    <content type="html">&lt;p&gt;通过上一篇&lt;a href=&quot;http://blog.csdn.net/kennethyo/article/details/50923909&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《 React-Native Android 学习笔记——1，配置环境》&lt;/a&gt;下载了AwesomeProject项目并运行了 demo。如下图：&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20160322185844293&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;br&gt;应该和你运行起来的相同，但是除了&lt;code&gt;Welcome to React Native&lt;/code&gt;的颜色。&lt;/p&gt;
&lt;h2 id=&quot;一，index-android-js-文件&quot;&gt;&lt;a href=&quot;#一，index-android-js-文件&quot; class=&quot;headerlink&quot; title=&quot;一，index.android.js 文件&quot;&gt;&lt;/a&gt;一，index.android.js 文件&lt;/h2&gt;&lt;p&gt;demo 默认展示在我们面前的这个页面其实是我们下载&lt;code&gt;AwesomeProject&lt;/code&gt;项目下的&lt;code&gt;index.android.js&lt;/code&gt;，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * Sample React Native App&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * https://github.com/facebook/react-native&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&#39;use strict&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; React, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  AppRegistry,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Component,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  StyleSheet,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Text,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  View,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react-native&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AwesomeProject&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Component&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  render() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.container&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.welcome&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Welcome to React Native!&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.instructions&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          To get started, edit index.android.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.instructions&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Shake or press menu button for dev menu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;View&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; styles = StyleSheet.create(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  container: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    flex: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    justifyContent: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alignItems: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    backgroundColor: &lt;span class=&quot;string&quot;&gt;&#39;#F5FCFF&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  welcome: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fontSize: &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    margin: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color:&lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  instructions: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color: &lt;span class=&quot;string&quot;&gt;&#39;#333333&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    marginBottom: &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;AppRegistry.registerComponent(&lt;span class=&quot;string&quot;&gt;&#39;AwesomeProject&#39;&lt;/span&gt;, () =&amp;gt; AwesomeProject);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;可以看到我在 welcome 的 style 中设置了&lt;code&gt;color:&amp;#39;red&amp;#39;&lt;/code&gt;，让我的&lt;code&gt;Welcome to React Native&lt;/code&gt;变成红色字体的。如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;welcome: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  fontSize: &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  margin: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  color:&lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;下面我们来熟悉一下&lt;code&gt;index.android.js&lt;/code&gt;这个文件里面的 js 代码都是干什么的。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;#39;use strict&amp;#39;&lt;/code&gt;是启动当前文件的 js 代码的严格模式，可以使当前的 js 更严格的条件下运行。想了解的可以学习这篇文章&lt;a href=&quot;http://www.ruanyifeng.com/blog/2013/01/javascript_strict_mode.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《Javascript 严格模式详解》&lt;/a&gt;。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; React, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  AppRegistry,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Component,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  StyleSheet,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Text,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  View,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react-native&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这段代码类似 java 的 import，把需要引用的 module 引入。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AwesomeProject&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Component&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  render() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.container&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.welcome&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Welcome to React Native!&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.instructions&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          To get started, edit index.android.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.instructions&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Shake or press menu button for dev menu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;View&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这段代码是渲染当前注册界面的布局，&lt;code&gt;render&lt;/code&gt;方法下的return 就是返回的当前布局。标签内的 style 对应下面这段代码，和 css 很像，等于 Android layout 文件下 view 的标签设置属性。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; styles = StyleSheet.create(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  container: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    flex: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    justifyContent: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alignItems: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    backgroundColor: &lt;span class=&quot;string&quot;&gt;&#39;#F5FCFF&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  welcome: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fontSize: &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    margin: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color:&lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  instructions: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color: &lt;span class=&quot;string&quot;&gt;&#39;#333333&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    marginBottom: &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;标签的具体规范可以看这里&lt;a href=&quot;http://facebook.github.io/react-native/docs/text.html#content&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Text&lt;/a&gt;，&lt;a href=&quot;http://facebook.github.io/react-native/docs/view.html#content&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;View&lt;/a&gt;。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;AppRegistry.registerComponent(&lt;span class=&quot;string&quot;&gt;&#39;AwesomeProject&#39;&lt;/span&gt;, () =&amp;gt; AwesomeProject);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;上面这段代码把我们 js 文件中的 class &lt;code&gt;AwesomeProject&lt;/code&gt;和我们 Android 项目中 &lt;code&gt;Activity&lt;/code&gt;中&lt;code&gt;getMainComponentName() { return &amp;quot;AwesomeProject&amp;quot;; }&lt;/code&gt;的 Activity关联起来。&lt;/p&gt;
&lt;h2 id=&quot;二，显示一个-Toast&quot;&gt;&lt;a href=&quot;#二，显示一个-Toast&quot; class=&quot;headerlink&quot; title=&quot;二，显示一个 Toast&quot;&gt;&lt;/a&gt;二，显示一个 Toast&lt;/h2&gt;&lt;p&gt;React-Native 已经把我们常用的模块都已经封装好了，例如 Toast 在&lt;code&gt;../AwesomeProject/node_modules/react-native/Libraries/Components/ToastAndroid/ToastAndroid.android.js&lt;/code&gt;中。&lt;br&gt;我们来看 ToastAndroid 的源码：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * Copyright (c) 2015-present, Facebook, Inc.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * All rights reserved.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * This source code is licensed under the BSD-style license found in the&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * LICENSE file in the root directory of this source tree. An additional grant&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * of patent rights can be found in the PATENTS file in the same directory.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @providesModule ToastAndroid&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&#39;use strict&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; RCTToastAndroid = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;NativeModules&#39;&lt;/span&gt;).ToastAndroid;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * This exposes the native ToastAndroid module as a JS module. This has a function &#39;show&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * which takes the following parameters:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * 1. String message: A string with the text to toast&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * 2. int duration: The duration of the toast. May be ToastAndroid.SHORT or ToastAndroid.LONG&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ToastAndroid = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  SHORT: RCTToastAndroid.SHORT,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  LONG: RCTToastAndroid.LONG,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  show: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    message: string,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    duration: number&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;): &lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RCTToastAndroid.show(message, duration);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = ToastAndroid;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;我们可以直接在引包当中加入ToastAndroid。如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; React, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  AppRegistry,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Component,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  StyleSheet,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Text,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ToastAndroid,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  View,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react-native&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;下面我们来用 ToastAndroid 弹出一个 Toast。在引包后加入代码&lt;code&gt;ToastAndroid.show(&amp;#39;Awesome&amp;#39;, ToastAndroid.SHORT);&lt;/code&gt;，下面来摇摆手机调出开发菜单，点击&lt;code&gt;Reload JS&lt;/code&gt;。就会弹出Toast。&lt;br&gt;我们来分析一下&lt;code&gt;ToastAndroid.android.js&lt;/code&gt;这个 module。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; RCTToastAndroid = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;NativeModules&#39;&lt;/span&gt;).ToastAndroid;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里是&lt;code&gt;require&lt;/code&gt;是加载&lt;code&gt;NativeModules&lt;/code&gt;模块，并把 &lt;code&gt;ToastAndroid&lt;/code&gt; 赋值给 &lt;code&gt;RCTToastAndroid&lt;/code&gt;。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ToastAndroid = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  SHORT: RCTToastAndroid.SHORT,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  LONG: RCTToastAndroid.LONG,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  show: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    message: string,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    duration: number&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;): &lt;span class=&quot;title&quot;&gt;void&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RCTToastAndroid.show(message, duration);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这段代码，创建一个对象赋值给&lt;code&gt;ToastAndroid&lt;/code&gt;，对象内分别设置了&lt;code&gt;Toast&lt;/code&gt;的 &lt;code&gt;SHORT&lt;/code&gt;，&lt;code&gt;LONG&lt;/code&gt;和&lt;code&gt;show&lt;/code&gt;方法。&lt;br&gt;&lt;code&gt;module.exports = ToastAndroid;&lt;/code&gt;这里把&lt;code&gt;ToastAndroid&lt;/code&gt;作为当前这个 Module 导出，提供给外部使用。&lt;br&gt;那么 JS 是如何 Android 代码关联起来的呢？下面我们来看一下Native 的代码。在 Android Studio 中搜索类 &lt;code&gt;ToastModule&lt;/code&gt;，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ToastModule&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReactContextBaseJavaModule&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String DURATION_SHORT_KEY = &lt;span class=&quot;string&quot;&gt;&quot;SHORT&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String DURATION_LONG_KEY = &lt;span class=&quot;string&quot;&gt;&quot;LONG&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ToastModule&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ReactApplicationContext reactContext)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(reactContext);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;title&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;ToastAndroid&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Map&amp;lt;String, Object&amp;gt; &lt;span class=&quot;title&quot;&gt;getConstants&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;String, Object&amp;gt; constants = MapBuilder.newHashMap();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    constants.put(DURATION_SHORT_KEY, Toast.LENGTH_SHORT);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    constants.put(DURATION_LONG_KEY, Toast.LENGTH_LONG);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; constants;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;meta&quot;&gt;@ReactMethod&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String message, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; duration)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Toast.makeText(getReactApplicationContext(), message, duration).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里&lt;code&gt;getName()&lt;/code&gt;方法的返回值对应 JS 中的&lt;code&gt;var RCTToastAndroid = require(&amp;#39;NativeModules&amp;#39;).ToastAndroid;&lt;/code&gt;结尾处的&lt;code&gt;ToastAndroid&lt;/code&gt;，正如 js 里的请求手机本地的 modules ，对应到类里的&lt;code&gt;getName()&lt;/code&gt;返回值。&lt;br&gt;&lt;code&gt;getConstants()&lt;/code&gt;方法负责把类中的常量映射到 JS 中去。&lt;br&gt;&lt;code&gt;show(String message, int duration)&lt;/code&gt;方法正是我们要提供给 JS 的方法，方法的注释代表这个方法提供给 JS 调用。&lt;/p&gt;
&lt;h2 id=&quot;三，自定义-Logger&quot;&gt;&lt;a href=&quot;#三，自定义-Logger&quot; class=&quot;headerlink&quot; title=&quot;三，自定义 Logger&quot;&gt;&lt;/a&gt;三，自定义 Logger&lt;/h2&gt;&lt;p&gt;这里我们来自定义一个 LoggerModule 来练练手。这里我先把代码贴出来了。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;LoggerModule&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReactContextBaseJavaModule&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String MODULE_NAME = &lt;span class=&quot;string&quot;&gt;&quot;Logger&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String TAG_KEY = &lt;span class=&quot;string&quot;&gt;&quot;TAG&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String TAG_VALUE = &lt;span class=&quot;string&quot;&gt;&quot;LoggerModule&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;LoggerModule&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ReactApplicationContext reactContext)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(reactContext);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Nullable&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Map&amp;lt;String, Object&amp;gt; &lt;span class=&quot;title&quot;&gt;getConstants&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;String, Object&amp;gt; constants = MapBuilder.newHashMap();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        constants.put(TAG_KEY, TAG_VALUE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; constants;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;title&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; MODULE_NAME;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@ReactMethod&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String tag, String msg)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Log.i(tag, msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@ReactMethod&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String tag, String msg)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Log.d(tag, msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@ReactMethod&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String tag, String msg)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Log.w(tag, msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@ReactMethod&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String tag, String msg)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Log.e(tag, msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里我把常量&lt;code&gt;TAG&lt;/code&gt;返回给 JS 调用，Module 命名为&lt;code&gt;Logger&lt;/code&gt;，并且把 info，debug，warn，error 等 Log 方法加上&lt;code&gt;@ReactMethod&lt;/code&gt;注释，提供给 JS调用。&lt;br&gt;这里还没有结束，我们还需要实现一个类，去注册我们自己写的 &lt;code&gt;LoggerModule&lt;/code&gt;。具体代码如下：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AppReactPackage&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReactPackage&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;NativeModule&amp;gt; &lt;span class=&quot;title&quot;&gt;createNativeModules&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ReactApplicationContext reactContext)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;NativeModule&amp;gt; modules = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        modules.add(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; LoggerModule(reactContext));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; modules;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;Class&amp;lt;? extends JavaScriptModule&amp;gt;&amp;gt; createJSModules() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Collections.emptyList();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;ViewManager&amp;gt; &lt;span class=&quot;title&quot;&gt;createViewManagers&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ReactApplicationContext reactContext)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Collections.emptyList();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后，把这个 AppReactPackage 注册到 Activity。如下：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ReactActivity&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * Returns the name of the main component registered from JavaScript.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * This is used to schedule rendering of the component.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; String &lt;span class=&quot;title&quot;&gt;getMainComponentName&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;AwesomeProject&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * Returns whether dev mode should be enabled.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * This enables e.g. the dev menu.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getUseDeveloperSupport&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; BuildConfig.DEBUG;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * A list of packages used by the app. If the app uses additional views&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * or modules besides the default ones, add more packages here.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; List&amp;lt;ReactPackage&amp;gt; &lt;span class=&quot;title&quot;&gt;getPackages&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; Arrays.&amp;lt;ReactPackage&amp;gt;asList(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; MainReactPackage(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; AppReactPackage()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;java 代码到这里就结束了。&lt;br&gt;下面，我们在&lt;code&gt;index.android.js&lt;/code&gt;的同级目录创建一个 js 文件&lt;code&gt;log.js&lt;/code&gt;。里面内容：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&#39;use strict&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; RCTLogger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;NativeModules&#39;&lt;/span&gt;).Logger;&lt;span class=&quot;comment&quot;&gt;//加载本地 modules，Module#getName()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; LogAndroid = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//添加定义的常量 Module#getConstants()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  TAG: RCTLogger.TAG,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;//添加的方法 Module#d()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;tag: string,msg: string&lt;/span&gt;):&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RCTLogger.d(tag,msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  i: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;tag: string,msg: string&lt;/span&gt;):&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RCTLogger.i(tag,msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  w: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;tag: string,msg: string&lt;/span&gt;):&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RCTLogger.w(tag,msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  e: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;tag: string,msg: string&lt;/span&gt;):&lt;span class=&quot;title&quot;&gt;void&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RCTLogger.e(tag,msg);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = LogAndroid;&lt;span class=&quot;comment&quot;&gt;//module 导出&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这里不用多说了，无非就是创建一个 LogAndroid 对象获取 &lt;code&gt;LoggerModule&lt;/code&gt;java 类中的常量，方法等，并且导出。&lt;br&gt;下面我贴出完整的&lt;code&gt;index.android.js&lt;/code&gt;，里面显示如何引用：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * Sample React Native App&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * https://github.com/facebook/react-native&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&#39;use strict&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; React, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  AppRegistry,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Component,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  StyleSheet,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Text,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ToastAndroid,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  View,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;react-native&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; LogAndroid = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;./log&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LogAndroid.i(LogAndroid.TAG,&lt;span class=&quot;string&quot;&gt;&quot;Awesome&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LogAndroid.d(LogAndroid.TAG,&lt;span class=&quot;string&quot;&gt;&quot;Awesome&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LogAndroid.w(LogAndroid.TAG,&lt;span class=&quot;string&quot;&gt;&quot;Awesome&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LogAndroid.e(LogAndroid.TAG,&lt;span class=&quot;string&quot;&gt;&quot;Awesome&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ToastAndroid.show(&lt;span class=&quot;string&quot;&gt;&#39;Awesome&#39;&lt;/span&gt;, ToastAndroid.SHORT);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AwesomeProject&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Component&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  render() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.container&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.welcome&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Welcome to React Native!&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.instructions&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          To get started, edit index.android.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&amp;#123;styles.instructions&amp;#125;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          Shake or press menu button for dev menu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;Text&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;View&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; styles = StyleSheet.create(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  container: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    flex: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    justifyContent: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    alignItems: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    backgroundColor: &lt;span class=&quot;string&quot;&gt;&#39;#F5FCFF&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  welcome: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fontSize: &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    margin: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color:&lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  instructions: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    textAlign: &lt;span class=&quot;string&quot;&gt;&#39;center&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    color: &lt;span class=&quot;string&quot;&gt;&#39;#333333&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    marginBottom: &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;AppRegistry.registerComponent(&lt;span class=&quot;string&quot;&gt;&#39;AwesomeProject&#39;&lt;/span&gt;, () =&amp;gt; AwesomeProject);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;重新编译并运行你的 app，看看 logcat 打印出了日志吗？&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;通过上一篇&lt;a href=&quot;http://blog.csdn.net/kennethyo/article/details/50923909&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《 React-Native Android 学习笔记——1，配置环境
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="React-Native" scheme="http://kennethyo.me/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>[原]React-Native Android 学习笔记——1，配置环境</title>
    <link href="http://kennethyo.me/2016/03/18/2016-03-18/"/>
    <id>http://kennethyo.me/2016/03/18/2016-03-18/</id>
    <published>2016-03-18T07:30:43.000Z</published>
    <updated>2016-09-01T06:37:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;一，设备与环境&quot;&gt;&lt;a href=&quot;#一，设备与环境&quot; class=&quot;headerlink&quot; title=&quot;一，设备与环境&quot;&gt;&lt;/a&gt;一，设备与环境&lt;/h2&gt;&lt;h3 id=&quot;1，一台-mac&quot;&gt;&lt;a href=&quot;#1，一台-mac&quot; class=&quot;headerlink&quot; title=&quot;1，一台 mac&quot;&gt;&lt;/a&gt;1，一台 mac&lt;/h3&gt;&lt;h3 id=&quot;2，安装软件包管理器-Homebrew-中文&quot;&gt;&lt;a href=&quot;#2，安装软件包管理器-Homebrew-中文&quot; class=&quot;headerlink&quot; title=&quot;2，安装软件包管理器 Homebrew(中文)&quot;&gt;&lt;/a&gt;2，安装软件包管理器 &lt;a href=&quot;http://brew.sh/index_zh-cn.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homebrew(中文)&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;终端里输入&lt;code&gt;/usr/bin/ruby -e &amp;quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&amp;quot;&lt;/code&gt;进行安装。&lt;/p&gt;
&lt;h3 id=&quot;3，安装-wget-或者-curl&quot;&gt;&lt;a href=&quot;#3，安装-wget-或者-curl&quot; class=&quot;headerlink&quot; title=&quot;3，安装 wget 或者 curl&quot;&gt;&lt;/a&gt;3，安装 &lt;a href=&quot;https://zh.wikipedia.org/wiki/Wget&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;wget&lt;/a&gt; 或者 &lt;a href=&quot;https://zh.wikipedia.org/wiki/CURL&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;curl&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;wget，终端里输入&lt;code&gt;brew install wget&lt;/code&gt;进行安装。&lt;br&gt;curl，终端里输入&lt;code&gt;brew install curl&lt;/code&gt;进行安装。&lt;/p&gt;
&lt;h3 id=&quot;4，安装-nvm-node版本管理器&quot;&gt;&lt;a href=&quot;#4，安装-nvm-node版本管理器&quot; class=&quot;headerlink&quot; title=&quot;4，安装 nvm (node版本管理器)&quot;&gt;&lt;/a&gt;4，安装 &lt;a href=&quot;https://github.com/creationix/nvm#installation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nvm&lt;/a&gt; (node版本管理器)&lt;/h3&gt;&lt;p&gt;如果安装了 wget，终端输入&lt;code&gt;wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bash&lt;/code&gt;进行安装 nvm。&lt;/p&gt;
&lt;p&gt;如果安装了 curl，终端输入&lt;code&gt;curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.0/install.sh | bashÂ&lt;/code&gt;进行安装 nvm。&lt;/p&gt;
&lt;h3 id=&quot;5，Android-SDK&quot;&gt;&lt;a href=&quot;#5，Android-SDK&quot; class=&quot;headerlink&quot; title=&quot;5，Android SDK&quot;&gt;&lt;/a&gt;5，Android SDK&lt;/h3&gt;&lt;p&gt;这个不用多说了，相信大家都会的。顺便把 Android SDK 配置到环境变量。&lt;/p&gt;
&lt;p&gt;如果你没有 Android SDK，也可以通过终端输入&lt;code&gt;brew install android-sdk&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id=&quot;二，安装和初始react-native-demo&quot;&gt;&lt;a href=&quot;#二，安装和初始react-native-demo&quot; class=&quot;headerlink&quot; title=&quot;二，安装和初始react-native demo&quot;&gt;&lt;/a&gt;二，安装和初始react-native demo&lt;/h2&gt;&lt;p&gt;终端输入&lt;code&gt;npm install -g react-native-cli&lt;/code&gt;安装 react-native。&lt;/p&gt;
&lt;p&gt;如果显示&lt;code&gt;EACCES: permission denied&lt;/code&gt;，用超级权限再次执行一下上面的指令。反正我是没遇到。&lt;/p&gt;
&lt;p&gt;进入到你要创建 demo 的目录，终端输入&lt;code&gt;cd 你得文件路径&lt;/code&gt;.&lt;br&gt;终端输入&lt;code&gt;react-native init AwesomeProject&lt;/code&gt;，初始 AwesomeProject 。&lt;/p&gt;
&lt;p&gt;终端输入&lt;code&gt;cd AwesomeProject&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;终端输入&lt;code&gt;react-native run-android&lt;/code&gt;可以直接运行 node 服务并编译运行 Android 项目，直至安装到手机。&lt;/p&gt;
&lt;p&gt;如果界面报错提示如下：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Unable to download JS bundle&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;com.facebook.react.devsupport.DebugServerException: Could not connect to development server.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;URL: http://localhost:8081/index.android.bundle?platform=android&amp;amp;dev=true&amp;amp;hot=false&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Try the following to fix the issue:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;• Ensure that the packager server is running&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;• Ensure that your device/emulator is connected to your machine and has USB debugging enabled - run &amp;apos;adb devices&amp;apos; to see a list of connected devices&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;• If you&amp;apos;re on a physical device connected to the same machine, run &amp;apos;adb reverse tcp:8081 tcp:8081&amp;apos; to forward requests from your device&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;• If your device is on the same Wi-Fi network, set &amp;apos;Debug server host &amp;amp; port for device&amp;apos; in &amp;apos;Dev settings&amp;apos; to your machine&amp;apos;s IP address and the port of the local dev server - e.g. 10.0.1.1:8081&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;at com.facebook.react.devsupport.DevServerHelper$1.onFailure(DevServerHelper.java:203)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;at com.squareup.okhttp.Call$AsyncCall.execute(Call.java:175)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;at com.squareup.okhttp.internal.NamedRunnable.run(NamedRunnable.java:33)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1113)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:588)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;at java.lang.Thread.run(Thread.java:818)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;一般在终端输入&lt;code&gt;adb reverse tcp:8081 tcp:8081&lt;/code&gt;即可解决，其他请详细看 log。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;一，设备与环境&quot;&gt;&lt;a href=&quot;#一，设备与环境&quot; class=&quot;headerlink&quot; title=&quot;一，设备与环境&quot;&gt;&lt;/a&gt;一，设备与环境&lt;/h2&gt;&lt;h3 id=&quot;1，一台-mac&quot;&gt;&lt;a href=&quot;#1，一台-mac&quot; class=&quot;headerli
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="React-Native" scheme="http://kennethyo.me/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>[原]Android 自定义字体，字替换为图片</title>
    <link href="http://kennethyo.me/2015/12/03/2015-12-03/"/>
    <id>http://kennethyo.me/2015/12/03/2015-12-03/</id>
    <published>2015-12-03T05:54:59.000Z</published>
    <updated>2016-09-01T06:38:06.000Z</updated>
    
    <content type="html">&lt;p&gt;不久前开发的版本中有这样一个需求，根据服务器返回的分数，显示分数，各位可能觉得这有什么呢？那么请看下图。&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151203113652497&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151203113712189&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151203113725790&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151203113742294&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;没错，这就是我们的需求。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;####思路一，&lt;br&gt;添加字体库，通过设置 TextView，在初始化的时候设置我们的字体。例如：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;TextView textView = (TextView) findViewById(R.id.custom);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 将字体文件保存在assets/fonts/目录下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Typeface typeFace =  Typeface.createFromAsset(getAssets(),&lt;span class=&quot;string&quot;&gt;&quot;fonts/your_font_name.ttf&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 应用字体&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;textView.setTypeface(typeFace);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;####思路二，&lt;br&gt;通过 自定义 View，根据分数算出每个字的位置，通过canvas 画出。通过如下方法：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;canvas.drawBitmap(&lt;span class=&quot;meta&quot;&gt;@NonNull&lt;/span&gt; Bitmap bitmap, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; left, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; top, &lt;span class=&quot;meta&quot;&gt;@Nullable&lt;/span&gt; Paint paint)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;####解决方案：&lt;br&gt;按照上面的思路，我直接去找设计妹子，说能给我做成字体库吗？然后我就被抓成土豆丝了。回来我自己了解了一下做字体库，通过了解，为这几个字（0，1，2，3，4，5，6，7，8，9，分，@#%作为一个字），做字体库显然成本比较大。&lt;/p&gt;
&lt;p&gt;思路一不行，就思路二吧。思路麻烦在于，要分别处理，两个字（0分），三个字（60分），四个字（100分）和@#%，四种情况。&lt;/p&gt;
&lt;p&gt;分清了几种状态，就可以开始着手开发了，就在这时，这时，我想到，这个，这个，不就和年初看的 emoji 表情是一个意思吗，只不过换成我自己的表情而已。&lt;/p&gt;
&lt;p&gt;年初看的 emoji 表情，是 &lt;a href=&quot;https://github.com/rockerhieu/emojicon&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;github 上的一个项目&lt;/a&gt;，其主要原理是，通过判断字符来替换相应的字符码为 emoji 图片。&lt;/p&gt;
&lt;p&gt;这是自定义的 TextView&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FaceRateTextView&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TextView&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FaceRateTextView&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Context context)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(context);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        init();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FaceRateTextView&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Context context, AttributeSet attrs)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(context, attrs);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        init();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FaceRateTextView&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Context context, AttributeSet attrs, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; defStyleAttr)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(context, attrs, defStyleAttr);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        init();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!TextUtils.isEmpty(getText())) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            setText(getText());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(CharSequence text, BufferType type)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!TextUtils.isEmpty(text)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            SpannableStringBuilder builder = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SpannableStringBuilder(text);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            FontsHandler.addFonts(getContext(), builder, (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) getTextSize(), (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) getTextSize());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            text = builder;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.setText(text, type);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;FontsHandler，是通过正则判断字符串当中有没有要替换的字符，并且替换为 DynamicDrawableSpan。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FontsHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;String, Integer&amp;gt; mFonts = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;(&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;分&quot;&lt;/span&gt;, R.drawable.ic_face_rate);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;0&quot;&lt;/span&gt;, R.drawable.ic_face_rate_0);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;, R.drawable.ic_face_rate_1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;2&quot;&lt;/span&gt;, R.drawable.ic_face_rate_2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;3&quot;&lt;/span&gt;, R.drawable.ic_face_rate_3);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;4&quot;&lt;/span&gt;, R.drawable.ic_face_rate_4);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;5&quot;&lt;/span&gt;, R.drawable.ic_face_rate_5);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;6&quot;&lt;/span&gt;, R.drawable.ic_face_rate_6);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;7&quot;&lt;/span&gt;, R.drawable.ic_face_rate_7);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;8&quot;&lt;/span&gt;, R.drawable.ic_face_rate_8);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;9&quot;&lt;/span&gt;, R.drawable.ic_face_rate_9);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFonts.put(&lt;span class=&quot;string&quot;&gt;&quot;balala&quot;&lt;/span&gt;, R.drawable.ic_face_rate_balala);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;addFonts&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Context context, Spannable spannable, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; textSize)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; hasChanges = &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;String, Integer&amp;gt; entry : mFonts.entrySet()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String key = entry.getKey();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Matcher matcher = Pattern.compile(Pattern.quote(key)).matcher(spannable);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (matcher.find()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; set = &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (FontsSpan span : spannable.getSpans(matcher.start(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        matcher.end(), FontsSpan.class))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (spannable.getSpanStart(span) &amp;gt;= matcher.start()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &amp;amp;&amp;amp; spannable.getSpanEnd(span) &amp;lt;= matcher.end())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        spannable.removeSpan(span);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        set = &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (set) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    hasChanges = &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    spannable.setSpan(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; FontsSpan(context, entry.getValue(), size, textSize),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            matcher.start(), matcher.end(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; hasChanges;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;FontsSpan 继承于DynamicDrawableSpan，主要实现替换字符为 drawable。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FontsSpan&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;DynamicDrawableSpan&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Context mContext;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mResourceId;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mTextSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mHeight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mWidth;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mTop;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; Drawable mDrawable;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; WeakReference&amp;lt;Drawable&amp;gt; mDrawableRef;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;FontsSpan&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Context context, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; resourceId, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; textSize)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(DynamicDrawableSpan.ALIGN_BASELINE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mContext = context;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mResourceId = resourceId;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mWidth = mHeight = mSize = size;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mTextSize = textSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; Drawable &lt;span class=&quot;title&quot;&gt;getDrawable&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (mDrawable == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mDrawable = mContext.getResources().getDrawable(mResourceId);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mHeight = mSize;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mWidth = mHeight * mDrawable.getIntrinsicWidth() / mDrawable.getIntrinsicHeight();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mTop = (mTextSize - mHeight) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mDrawable.setBounds(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, mTop, mWidth, mTop + mHeight);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// swallow&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; mDrawable;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Canvas canvas, CharSequence text, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; start, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; end, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; x, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; top, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; y, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; bottom, Paint paint)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//super.draw(canvas, text, start, end, x, top, y, bottom, paint);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Drawable b = getCachedDrawable();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        canvas.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; transY = bottom - b.getBounds().bottom;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (mVerticalAlignment == ALIGN_BASELINE) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            transY = top + ((bottom - top) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) - ((b.getBounds().bottom - b.getBounds().top) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) - mTop;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        canvas.translate(x, transY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        b.draw(canvas);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        canvas.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; Drawable &lt;span class=&quot;title&quot;&gt;getCachedDrawable&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (mDrawableRef == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt; || mDrawableRef.get() == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            mDrawableRef = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; WeakReference&amp;lt;Drawable&amp;gt;(getDrawable());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; mDrawableRef.get();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;其实原理很简单，并不复杂。&lt;br&gt;&lt;a href=&quot;https://github.com/KennethYo/ScanNeedleDemo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;demo代码地址&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;不久前开发的版本中有这样一个需求，根据服务器返回的分数，显示分数，各位可能觉得这有什么呢？那么请看下图。&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151203113652497&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;br&gt;&lt;img src=
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="View" scheme="http://kennethyo.me/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>[原]Android 翻转动画 Rotate3dAnimation 效果</title>
    <link href="http://kennethyo.me/2015/10/16/2015-10-16/"/>
    <id>http://kennethyo.me/2015/10/16/2015-10-16/</id>
    <published>2015-10-16T09:05:57.000Z</published>
    <updated>2016-09-01T06:38:25.000Z</updated>
    
    <content type="html">&lt;p&gt;十一前请了一天假，后面请了三天假，串起来一共休息了十二天，这期间见了女朋友的家长，也领女朋友见了我家长，好消息是各方家长反馈不错，坏消息是涨了五斤肉，毕竟是吃了12天的呼伦贝儿牛羊肉哈。玩了这么多天，回来要收收心好好工作了，毕竟要攒钱娶媳妇哈~&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;上班回来，按照产品的需求做了这样一个效果，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20151016162517318&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;这其中包含了3个动画，分别是移动动画、放大动画、旋转动画。&lt;/p&gt;
&lt;p&gt;前两个动画比较好完成，可以用 TranslateAnimation 和 ScaleAnimation来完成，但是第三个就比较麻烦了，因为这个旋转动画是根据 Y 轴来旋转的，而 RotateAnimation 是根据垂直屏幕的 Z 轴旋转的，所以 RotateAnimation 并不能够完成我们需要的效果，这里就需要我们去继承 Animation 去自定义动画了。&lt;/p&gt;
&lt;p&gt;但是！！！&lt;br&gt;但是 APIdemo 里面已经实现了这个动画，so，我们拿来用就好了，下面是我贴出来的Rotate3dAnimation，其中我添加了一个构造，添加了相对自己位置的 type。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;package&lt;/span&gt; cn.kenneth.rotate3danimation;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; android.graphics.Camera;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; android.graphics.Matrix;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; android.view.animation.Animation;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; android.view.animation.Transformation;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Rotate3dAnimation&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Animation&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mCenterXType = ABSOLUTE;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; mCenterYType = ABSOLUTE;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; mFromDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; mToDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; mCenterX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; mCenterY;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; mDepthZ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; mReverse;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; Camera mCamera;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * Creates a new 3D rotation on the Y axis. The rotation is defined by its&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * start angle and its end angle. Both angles are in degrees. The rotation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * is performed around a center point on the 2D space, definied by a pair&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * of X and Y coordinates, called centerX and centerY. When the animation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * starts, a translation on the Z axis (depth) is performed. The length&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * of the translation can be specified, as well as whether the translation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * should be reversed in time.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; fromDegrees the start angle of the 3D rotation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; toDegrees   the end angle of the 3D rotation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; centerX     the X center of the 3D rotation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; centerY     the Y center of the 3D rotation&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; reverse     true if the translation should be reversed, false otherwise&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Rotate3dAnimation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; fromDegrees, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; toDegrees,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; centerX, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; centerY, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; depthZ, &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; reverse)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFromDegrees = fromDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mToDegrees = toDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterX = centerX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterY = centerY;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mDepthZ = depthZ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mReverse = reverse;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Rotate3dAnimation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; fromDegrees, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; toDegrees,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                             &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; centerXType, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; centerX, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; centerYType, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; centerY, &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; depthZ, &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; reverse)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mFromDegrees = fromDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mToDegrees = toDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterXType = centerXType;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterX = centerX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterYType = centerYType;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterY = centerY;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mDepthZ = depthZ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mReverse = reverse;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; width, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; height, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; parentWidth, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; parentHeight)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.initialize(width, height, parentWidth, parentHeight);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCamera = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Camera();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterX = resolveSize(mCenterXType, mCenterX, width, parentWidth);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mCenterY = resolveSize(mCenterYType, mCenterY, height, parentHeight);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;applyTransformation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; interpolatedTime, Transformation t)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; fromDegrees = mFromDegrees;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; degrees = fromDegrees + ((mToDegrees - fromDegrees) * interpolatedTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; centerX = mCenterX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt; centerY = mCenterY;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Camera camera = mCamera;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Matrix matrix = t.getMatrix();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        camera.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (mReverse) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            camera.translate(&lt;span class=&quot;number&quot;&gt;0.0f&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0.0f&lt;/span&gt;, mDepthZ * interpolatedTime);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            camera.translate(&lt;span class=&quot;number&quot;&gt;0.0f&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0.0f&lt;/span&gt;, mDepthZ * (&lt;span class=&quot;number&quot;&gt;1.0f&lt;/span&gt; - interpolatedTime));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        camera.rotateY(degrees);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        camera.getMatrix(matrix);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        camera.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        matrix.preTranslate(-centerX, -centerY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        matrix.postTranslate(centerX, centerY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;移动动画也比较好做，点击的时候记录点击 icon 在 window 上的位置，然后传到下一个界面，计算一下偏移量。&lt;/p&gt;
&lt;p&gt;这里面要注意，里面的 weibo 等 icon，我用的并不是图片，用的是FontAwesome，具体用法看下面博客：&lt;br&gt;中文地址：&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MjM5NDAxNTY4MA==&amp;amp;mid=208795106&amp;amp;idx=1&amp;amp;sn=7745289b193dc8ff20ba81ff9bb23b21&amp;amp;scene=1&amp;amp;srcid=1016s8Satc5ZO0gDrVLqVIBM&amp;amp;key=b410d3164f5f798e7ec8a5a17847eeddc1247303cf5fe40ac8a564295602dd6161bb83fa346de7cd9878b60274b20e77&amp;amp;ascene=0&amp;amp;uin=MTAxNzk0OTM1&amp;amp;devicetype=iMac+MacBookPro11%2C1+OSX+OSX+10.11+build(15A284&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;&amp;amp;version=11020201&amp;amp;pass_ticket=WHgV251%2BEh%2Bkh7UMBqQp034b8MGYzxeoJ7l9Ncwz3iE%3D)&lt;br&gt;项目网站：&lt;a href=&quot;http://fortawesome.github.io/Font-Awesome/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;demo 代码地址：&lt;a href=&quot;https://github.com/KennethYo/Rotate3dAnimation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;十一前请了一天假，后面请了三天假，串起来一共休息了十二天，这期间见了女朋友的家长，也领女朋友见了我家长，好消息是各方家长反馈不错，坏消息是涨了五斤肉，毕竟是吃了12天的呼伦贝儿牛羊肉哈。玩了这么多天，回来要收收心好好工作了，毕竟要攒钱娶媳妇哈~&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;上班
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="Animation" scheme="http://kennethyo.me/tags/Animation/"/>
    
  </entry>
  
  <entry>
    <title>[原]Android 可拖拽 GridView 并且实时切换和拖动到下部删除</title>
    <link href="http://kennethyo.me/2015/09/29/2015-09-29/"/>
    <id>http://kennethyo.me/2015/09/29/2015-09-29/</id>
    <published>2015-09-29T07:22:08.000Z</published>
    <updated>2016-09-01T06:39:45.000Z</updated>
    
    <content type="html">&lt;p&gt;最近在公司做了一个这样的需求，拖动GridView 中的 item 到指定区域删除，具体效果，请看下面的动图。&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150929150020321&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;拖动效果是通过隐藏 GridView中被选中的 item，并且同时在 Window 上注册一个 View 来实现，具体逻辑和代码，请参照这篇博客&lt;a href=&quot;http://blog.csdn.net/xiaanming/article/details/17718579。&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://blog.csdn.net/xiaanming/article/details/17718579。&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;我的需求当中，多了一个拖动到底部区域缩小并且删除。&lt;/p&gt;
&lt;p&gt;考虑到从 GridView 中拖动一个 item 到另一个 View 中，并且删除，只在 GridView 当中进行绘制被拖动的 item 肯定是达不到进入另一个 view 的效果，即使做起来也是相当麻烦的。&lt;/p&gt;
&lt;p&gt;我们可以在 GridView 和删除区域的上一层 View 当中进行绘制，但是看到&lt;a href=&quot;http://blog.csdn.net/xiaanming/article/details/17718579&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;拖动效果博客&lt;/a&gt;当中是直接注册在了 Window 上，这更加减少了工作量，直接在 GridView 当中判断如果用户拖动的坐标y 轴大于了 GridView 的高度，就可以进行缩小动画了。&lt;/p&gt;
&lt;p&gt;但是这里要注意的是，注册在 window 上的 View 不能直接在其最外层的  Layout 上进行动画，所以我对ImageView 进行了包裹，并且是对 ImageView 进行动画。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mDragImageView = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ImageView(getContext());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      mDragImageView.setImageBitmap(bitmap);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mDragImageView.setBackgroundResource(R.drawable.bg_shadow);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      mDragLayout = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; FrameLayout(getContext());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      mDragLayout.addView(mDragImageView);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      mWindowManager.addView(mDragLayout, mWindowLayoutParams);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;有了拖动效果实现的代码，其他都很简单，具体请参照代码，&lt;br&gt;&lt;a href=&quot;https://github.com/KennethYo/DragViewAndDelete&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;代码地址&lt;/a&gt;，其中里面的一些自定义标签都是我需求中自定义的，可以自行修改。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近在公司做了一个这样的需求，拖动GridView 中的 item 到指定区域删除，具体效果，请看下面的动图。&lt;br&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150929150020321&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;拖动
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="View" scheme="http://kennethyo.me/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>[原]高仿SinaWeibo新浪微博发布页面话题效果</title>
    <link href="http://kennethyo.me/2015/08/10/2015-08-10/"/>
    <id>http://kennethyo.me/2015/08/10/2015-08-10/</id>
    <published>2015-08-09T16:06:33.000Z</published>
    <updated>2016-09-01T06:38:45.000Z</updated>
    
    <content type="html">&lt;p&gt;最近做了一个仿新浪微博话题效果的功能,网上搜索了几个效果,都存在一定问题,最终借鉴别人的思路,完成这一套效果.&lt;/p&gt;
&lt;p&gt;首先,我们拆分逻辑以及开发顺序.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h6 id=&quot;1-实现话题变色效果&quot;&gt;&lt;a href=&quot;#1-实现话题变色效果&quot; class=&quot;headerlink&quot; title=&quot;1,实现话题变色效果&quot;&gt;&lt;/a&gt;1,实现话题变色效果&lt;/h6&gt;&lt;h6 id=&quot;2-实现插入话题效果&quot;&gt;&lt;a href=&quot;#2-实现插入话题效果&quot; class=&quot;headerlink&quot; title=&quot;2,实现插入话题效果&quot;&gt;&lt;/a&gt;2,实现插入话题效果&lt;/h6&gt;&lt;h6 id=&quot;3-实现话题选中删除效果&quot;&gt;&lt;a href=&quot;#3-实现话题选中删除效果&quot; class=&quot;headerlink&quot; title=&quot;3,实现话题选中删除效果&quot;&gt;&lt;/a&gt;3,实现话题选中删除效果&lt;/h6&gt;&lt;h6 id=&quot;4-实现点击话题-光标在话题之后&quot;&gt;&lt;a href=&quot;#4-实现点击话题-光标在话题之后&quot; class=&quot;headerlink&quot; title=&quot;4,实现点击话题,光标在话题之后&quot;&gt;&lt;/a&gt;4,实现点击话题,光标在话题之后&lt;/h6&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150809173121271&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;下面我们就一步一步实现效果.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;一-实现话题变色&quot;&gt;&lt;a href=&quot;#一-实现话题变色&quot; class=&quot;headerlink&quot; title=&quot;一,实现话题变色&quot;&gt;&lt;/a&gt;一,实现话题变色&lt;/h2&gt;&lt;p&gt;实现逻辑主要是通过&lt;code&gt;EditText&lt;/code&gt;的&lt;code&gt;addTextChangedListener()&lt;/code&gt;来进行监听文本变动,通过正则表达式来匹配出文本中的话题.&lt;/p&gt;
&lt;h5 id=&quot;利用正则表达式获取全部话题&quot;&gt;&lt;a href=&quot;#利用正则表达式获取全部话题&quot; class=&quot;headerlink&quot; title=&quot;利用正则表达式获取全部话题:&quot;&gt;&lt;/a&gt;利用正则表达式获取全部话题:&lt;/h5&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//正则表达式,一定要和服务器以及 iOS 端统一&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String topicRegex = &lt;span class=&quot;string&quot;&gt;&quot;#([^#]+?)#&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; ArrayList&amp;lt;String&amp;gt; &lt;span class=&quot;title&quot;&gt;findTopic&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String s)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Pattern p = Pattern.compile(topicRegex);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Matcher m = p.matcher(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ArrayList&amp;lt;String&amp;gt; list = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (m.find()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            list.add(m.group());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; list;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;通过正则表达式匹配出的话题集合-遍历出每个话题的-startIndex-位置-后来发现Matcher方法是有获取-index-的方法-并且通过EditText-getText-方法获取的Editable直接对文本进行操作&quot;&gt;&lt;a href=&quot;#通过正则表达式匹配出的话题集合-遍历出每个话题的-startIndex-位置-后来发现Matcher方法是有获取-index-的方法-并且通过EditText-getText-方法获取的Editable直接对文本进行操作&quot; class=&quot;headerlink&quot; title=&quot;通过正则表达式匹配出的话题集合,遍历出每个话题的 startIndex 位置(后来发现Matcher方法是有获取 index 的方法),并且通过EditText.getText()方法获取的Editable直接对文本进行操作:&quot;&gt;&lt;/a&gt;通过正则表达式匹配出的话题集合,遍历出每个话题的 startIndex 位置(后来发现&lt;code&gt;Matcher&lt;/code&gt;方法是有获取 index 的方法),并且通过&lt;code&gt;EditText.getText()&lt;/code&gt;方法获取的&lt;code&gt;Editable&lt;/code&gt;直接对文本进行操作:&lt;/h5&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onTextChanged&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(CharSequence s, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; start, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; before, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; count)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Log.i(&lt;span class=&quot;string&quot;&gt;&quot;MainActivity&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;onTextChanged&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (TextUtils.isEmpty(s)) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//1,查找话题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        String content = s.toString();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mTopicList.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mTopicList.addAll(findTopic(s.toString()));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//2,为查找出的变色&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//首先要为editable,去除之前设置的colorSpan&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Editable editable = mEditText.getText();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; mColorSpans.size(); i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            editable.removeSpan(mColorSpans.get(i));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mColorSpans.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//为editable,中的话题加入colorSpan&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; findPos = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size = mTopicList.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; size; i++) &amp;#123;&lt;span class=&quot;comment&quot;&gt;//便利话题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String topic = mTopicList.get(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            findPos = content.indexOf(topic, findPos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (findPos != -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ForegroundColorSpan colorSpan = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ForegroundColorSpan(Color.BLUE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                editable.setSpan(colorSpan, findPos, findPos = findPos + topic.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mColorSpans.add(colorSpan);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&quot;二-实现插入话题效果&quot;&gt;&lt;a href=&quot;#二-实现插入话题效果&quot; class=&quot;headerlink&quot; title=&quot;二,实现插入话题效果&quot;&gt;&lt;/a&gt;二,实现插入话题效果&lt;/h2&gt;&lt;p&gt;新浪微博的插入话题效果,是开启一个新的页面,点击一个话题后,插入光标所在的位置.这里我用一个按钮模仿了这个动作.要注意的是,要记录插入之前光标的位置,并且在插入话题后,把光标放置在话题之后:&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v.getId() == R.id.button) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//插入话题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; selectionStart = mEditText.getSelectionStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//下面这些操作也可以直接替换为操作 EditText 的Editable实现,下面的代码 review 后看起来由点蠢,直接调用 insert 方法比较巧妙&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String content = mEditText.getText().toString();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String firstStr = content.substring(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, selectionStart);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String secondStr = content.substring(selectionStart, content.length());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String insertTopic = &lt;span class=&quot;string&quot;&gt;&quot;#这是一个插入的话题#&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            mEditText.setText(firstStr + insertTopic + secondStr);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            mEditText.setSelection(selectionStart + insertTopic.length());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;三-实现话题选中删除效果&quot;&gt;&lt;a href=&quot;#三-实现话题选中删除效果&quot; class=&quot;headerlink&quot; title=&quot;三,实现话题选中删除效果&quot;&gt;&lt;/a&gt;三,实现话题选中删除效果&lt;/h2&gt;&lt;p&gt;这里也是要时时判断光标所在的位置,当光标出现在话题之后,再次点击删除,就截获为选中话题效果,实现起来也是很简单的.&lt;/p&gt;
&lt;p&gt;但是要注意的是,我们不能利用 activity 里面的&lt;code&gt;onKeyDown()&lt;/code&gt;和&lt;code&gt;onKeyUp()&lt;/code&gt;两个回调,通过 log 发现文本变动和按键点击的回调顺序为&lt;code&gt;beforeTextChanged-&amp;gt;onTextChanged-&amp;gt;afterTextChanged-&amp;gt;onKeyDown-&amp;gt;onKeyUp&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;这也说明了如果通过 拦截&lt;code&gt;onKeyDown()&lt;/code&gt;和&lt;code&gt;onKeyUp()&lt;/code&gt;两个回调时,文本是已经删除之后的文本,并能有效的达到我们要实现的目的,那么有没有是文本改变之前就能截取到按键的方法呢?&lt;/p&gt;
&lt;p&gt;其实我们可以通过监听&lt;code&gt;EditText&lt;/code&gt;的&lt;code&gt;setOnKeyListener()&lt;/code&gt;方法来监听按键(&lt;code&gt;onKey-&amp;gt;beforeTextChanged-&amp;gt;onTextChanged-&amp;gt;afterTextChanged-&amp;gt;onKeyDown-&amp;gt;onKeyUp&lt;/code&gt;):&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onKey&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(View v, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; keyCode, KeyEvent event)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Log.i(&lt;span class=&quot;string&quot;&gt;&quot;MainActivity&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;onKey&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (keyCode == KeyEvent.KEYCODE_DEL &amp;amp;&amp;amp; event.getAction() == KeyEvent.ACTION_DOWN &amp;amp;&amp;amp; mCheckBox2.isChecked()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; selectionStart = mEditText.getSelectionStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; selectionEnd = mEditText.getSelectionEnd();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;comment&quot;&gt;//如果光标起始和结束在同一位置,说明是选中效果,直接返回 false 交给系统执行删除动作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (selectionStart != selectionEnd) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Editable editable = mEditText.getText();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            String content = editable.toString();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; lastPos = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size = mTopicList.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;//遍历判断光标的位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; size; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                String topic = mTopicList.get(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                lastPos = content.indexOf(topic, lastPos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lastPos != -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (selectionStart != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; selectionStart &amp;gt;= lastPos &amp;amp;&amp;amp; selectionStart &amp;lt;= (lastPos + topic.length())) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;comment&quot;&gt;//选中话题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        mEditText.setSelection(lastPos, lastPos + topic.length());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                lastPos += topic.length();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;四-实现点击话题-光标在话题之后&quot;&gt;&lt;a href=&quot;#四-实现点击话题-光标在话题之后&quot; class=&quot;headerlink&quot; title=&quot;四,实现点击话题,光标在话题之后&quot;&gt;&lt;/a&gt;四,实现点击话题,光标在话题之后&lt;/h2&gt;&lt;p&gt;逻辑处理就是监听&lt;code&gt;EditText&lt;/code&gt;的点击事件,处理光标所在位置,如果在位置在话题内,立即放置在话题的后面,逻辑比较简单,直接上代码:&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (v.getId() == R.id.editText &amp;amp;&amp;amp; mCheckBox1.isChecked()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; selectionStart = mEditText.getSelectionStart();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; lastPos = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; size = mTopicList.size();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; size; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                String topic = mTopicList.get(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                lastPos = mEditText.getText().toString().indexOf(topic, lastPos);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (lastPos != -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (selectionStart &amp;gt;= lastPos &amp;amp;&amp;amp; selectionStart &amp;lt;= (lastPos + topic.length())) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;comment&quot;&gt;//在这position 区间就移动光标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        mEditText.setSelection(lastPos + topic.length());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                lastPos = lastPos + topic.length();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;最终还是有点小遗憾没有完成.当拷贝一段已经变色的话题,再粘贴到文本后,无法删除掉拷贝进来文本的变色效果,尝试调用&lt;code&gt;Editable.clearSpans()&lt;/code&gt;去除全部 span 也无法实现,并且这个方法会导致直接卡死.后来直接使用&lt;code&gt;EditText.setText()&lt;/code&gt;控制文本,确实达到了效果,但是当输入法是类似 mx4默认输入法效果时(效果大概是,输入的拼音直接显示在 EditText 里面,点击被选汉字,替换掉拼音),会把输入的拼音放入到文本里,所以上面的代码,我一般是直接操作 Editable.&lt;/p&gt;
&lt;p&gt;如果有更好的方法或者修复了上面的小遗憾,请留言指教.&lt;/p&gt;
&lt;p&gt;Demo 地址：&lt;a href=&quot;https://github.com/KennethYo/SinaTopic&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/KennethYo/SinaTopic&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;转载请注明出处:&lt;a href=&quot;http://www.kennethyo.me&quot;&gt;http://www.kennethyo.me&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近做了一个仿新浪微博话题效果的功能,网上搜索了几个效果,都存在一定问题,最终借鉴别人的思路,完成这一套效果.&lt;/p&gt;
&lt;p&gt;首先,我们拆分逻辑以及开发顺序.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h6 id=&quot;1-实现话题变色效果&quot;&gt;&lt;a href=&quot;#1-实现话题变色效果
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[译]介绍MVP Model-View-Presenter在Android中的应用</title>
    <link href="http://kennethyo.me/2015/05/25/2015-05-25/"/>
    <id>http://kennethyo.me/2015/05/25/2015-05-25/</id>
    <published>2015-05-25T05:47:35.000Z</published>
    <updated>2016-09-01T06:39:29.000Z</updated>
    
    <content type="html">&lt;p&gt;这篇文章是我学习MVP模式时翻译的，原文是&lt;a href=&quot;http://konmik.github.io/author/konstantin-mikheev.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Konstantin Mikheev&lt;/a&gt;所写，&lt;a href=&quot;http://konmik.github.io/introduction-to-model-view-presenter-on-android.html?utm_source=Android+Weekly&amp;amp;utm_campaign=5589504b56-Android_Weekly_148&amp;amp;utm_medium=email&amp;amp;utm_term=0_4eb677ad19-5589504b56-337835113&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;。&lt;br&gt;因英语水平有限，翻译的很生硬，基本靠Google，请见谅。以下是译文。&lt;br&gt;转载请注明出处:&lt;a href=&quot;http://blog.csdn.net/kennethyo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://blog.csdn.net/kennethyo&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;这篇文章我会通过一个最简单的例子去一步步介绍MVP模式在Android中的最佳实践。同时我也会介绍一个使MVP模式在Android开发中变简单的library。&lt;/p&gt;
&lt;h1 id=&quot;简单？怎么才能从中获益呢？&quot;&gt;&lt;a href=&quot;#简单？怎么才能从中获益呢？&quot; class=&quot;headerlink&quot; title=&quot;简单？怎么才能从中获益呢？&quot;&gt;&lt;/a&gt;简单？怎么才能从中获益呢？&lt;/h1&gt;&lt;h2 id=&quot;什么是MVP&quot;&gt;&lt;a href=&quot;#什么是MVP&quot; class=&quot;headerlink&quot; title=&quot;什么是MVP&quot;&gt;&lt;/a&gt;什么是MVP&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;View&lt;/strong&gt;层是用来显示数据和相应数据操作的。在Android中，它可能是Activity，Fragment，View或者Dialog。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Model&lt;/strong&gt;层是数据访问层，例如数据库API或者远程服务器访问API。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Presenter&lt;/strong&gt;层提供View层和Model层的数据进行联系。Presenter层也可以控制后台Task。&lt;/p&gt;
&lt;p&gt;在Android中，MVP模式可以把后台线程从Activitys/Views/Fragments中脱离出来，使它们在大部分生命周期事件中更加独立。这样的应用变得更加简单，整个程序的稳定性提升了10倍不止，应用代码变得更加少，代码可维护性变得更加友善，开发者的生命变得更加开心。&lt;/p&gt;
&lt;h2 id=&quot;在Android中，为什么是MVP&quot;&gt;&lt;a href=&quot;#在Android中，为什么是MVP&quot; class=&quot;headerlink&quot; title=&quot;在Android中，为什么是MVP&quot;&gt;&lt;/a&gt;在Android中，为什么是MVP&lt;/h2&gt;&lt;h3 id=&quot;原因1：保持简单傻瓜&quot;&gt;&lt;a href=&quot;#原因1：保持简单傻瓜&quot; class=&quot;headerlink&quot; title=&quot;原因1：保持简单傻瓜&quot;&gt;&lt;/a&gt;原因1：保持简单傻瓜&lt;/h3&gt;&lt;p&gt;如果你还没读过这篇文章，请读一遍：&lt;a href=&quot;https://people.apache.org/~fhanik/kiss.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;The Kiss Principle&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·大多数Android程序仅仅使用了View-Model模式。
·程序员需要参与View的复杂性，而不是解决业务。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在应用中你仅仅使用Model-View，最后会落得“一切连接这一切”的状态。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150525132155795&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;如果这个示例图看起来不是那么复杂，那么想想每个View可能随时消失和随时出现。别忘了保存和恢复view的状态。为临时View attache 几个后台任务，蛋糕准备好了！&lt;/p&gt;
&lt;p&gt;另一种“一切连接着一切”就是上帝对象。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150525132227292&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;上地对象太过于复杂；代码块不能被重复利用，测试或方便的debug和重构。&lt;/p&gt;
&lt;h4 id=&quot;使用MVP模式&quot;&gt;&lt;a href=&quot;#使用MVP模式&quot; class=&quot;headerlink&quot; title=&quot;使用MVP模式&quot;&gt;&lt;/a&gt;使用MVP模式&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150525132427577&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·复杂的任务被分解成简单的任务，并且容易解决。
·更小的对象，更少的bug，更简单debug。
·可测试。
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;原因2：后台任务&quot;&gt;&lt;a href=&quot;#原因2：后台任务&quot; class=&quot;headerlink&quot; title=&quot;原因2：后台任务&quot;&gt;&lt;/a&gt;原因2：后台任务&lt;/h3&gt;&lt;p&gt;无论何时，你写Activity，Fragment或者自定义View，你可以把所有方法与后台任务的外部或者静态类联系起来。这样，你的后台任务将不会和一个Activity联系，不会造成内存泄露和不用Activity来消费。我叫这样的对象为“Presenter”。&lt;/p&gt;
&lt;p&gt;有那么几种处理后台线程的方法，但都是不可靠的，不过MVP是可靠的。&lt;/p&gt;
&lt;h4 id=&quot;为什么MVP可以&quot;&gt;&lt;a href=&quot;#为什么MVP可以&quot; class=&quot;headerlink&quot; title=&quot;为什么MVP可以&quot;&gt;&lt;/a&gt;为什么MVP可以&lt;/h4&gt;&lt;p&gt;通过这个视图，显示了不同的应用控件，在发生configuration发生改变或者内存溢出的时候发生了什么。每一个Android开发者都应该知道这个视图，然而这样一个视图并不是每个开发都知道。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150525133414325&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Case 1:&lt;/strong&gt;当用户旋转屏幕，改变语言设置， attache 一个外部显示器，等情况，通常Configuration会发生变化。更多关于[Configuration]&lt;br&gt;(&lt;a href=&quot;http://developer.android.com/reference/android/R.attr.html#configChanges)请阅读链接。&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://developer.android.com/reference/android/R.attr.html#configChanges)请阅读链接。&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Case 2:&lt;/strong&gt;当用户在开发者设置里面选择了“Don’t keep activities”或者其他Activity到最顶层，Activity会发生restart。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Case 3:&lt;/strong&gt;没有足够的内存和应用进入后台，process会restart。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最后&lt;/strong&gt;&lt;br&gt;现在你可以看到，Fragment当中设置setRetainInstance(true)在这里是没用帮助的，我们只需要设置save/restore就可以。因此，我们可以简单的去除Fragment的setRetainInstance方法，来限制问题的数量。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150525133504401&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;|Activity, View, Fragment, DialogFragment Static variables and threads | save/restore no change | save/restore reset |&lt;br&gt;现在看起来爽多了。我们在应用任何情况下，只需要写两段代码就可以完成restore：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·Activity，View，Fragment，DialogFragment的save/restore。
·线程restart，restart后台请求。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;第一部分，是Android API提供的方法。第二部分是Presenter层的工作。Presenter只要记住那些请求需要被执行，如果一个进程执行期间restart，Presenter将会重新执行它们。&lt;/p&gt;
&lt;h2 id=&quot;一个例子&quot;&gt;&lt;a href=&quot;#一个例子&quot; class=&quot;headerlink&quot; title=&quot;一个例子&quot;&gt;&lt;/a&gt;一个例子&lt;/h2&gt;&lt;p&gt;这个例子将加载服务器上得数据来显示一些items。如果出现错误将显示一个toast。&lt;/p&gt;
&lt;p&gt;我推荐使用&lt;a href=&quot;https://github.com/ReactiveX/RxJava&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RxJava&lt;/a&gt;来构建Presenter，因为这个Library控制数据流很简单。&lt;/p&gt;
&lt;p&gt;我也要感谢创建&lt;a href=&quot;http://www.icndb.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;The Internet Chuck Norris Database&lt;/a&gt;的人，我把它用在了我例子当中。&lt;/p&gt;
&lt;h2 id=&quot;没用MVP的例子00：&quot;&gt;&lt;a href=&quot;#没用MVP的例子00：&quot; class=&quot;headerlink&quot; title=&quot;没用MVP的例子00：&quot;&gt;&lt;/a&gt;没用MVP的&lt;a href=&quot;https://github.com/konmik/MVPExamples/tree/master/example00&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;例子00&lt;/a&gt;：&lt;/h2&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Activity&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String DEFAULT_NAME = &lt;span class=&quot;string&quot;&gt;&quot;Chuck Norris&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; ArrayAdapter&amp;lt;ServerAPI.Item&amp;gt; adapter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; Subscription subscription;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setContentView(R.layout.activity_main);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ListView listView = (ListView)findViewById(R.id.listView);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        listView.setAdapter(adapter = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayAdapter&amp;lt;&amp;gt;(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, R.layout.item));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        requestItems(DEFAULT_NAME);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onDestroy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onDestroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        unsubscribe();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;requestItems&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String name)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        unsubscribe();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        subscription = App.getServerAPI()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .getItems(name.split(&lt;span class=&quot;string&quot;&gt;&quot;\\s+&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], name.split(&lt;span class=&quot;string&quot;&gt;&quot;\\s+&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .delay(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, TimeUnit.SECONDS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .observeOn(AndroidSchedulers.mainThread())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .subscribe(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Action1&amp;lt;ServerAPI.Response&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ServerAPI.Response response)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    onItemsNext(response.items);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Action1&amp;lt;Throwable&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Throwable error)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    onItemsError(error);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onItemsNext&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ServerAPI.Item[] items)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        adapter.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        adapter.addAll(items);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onItemsError&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Throwable throwable)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Toast.makeText(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, throwable.getMessage(), Toast.LENGTH_LONG).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;unsubscribe&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (subscription != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            subscription.unsubscribe();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            subscription = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;一个有经验的开发会发现这个例子是有一些缺陷的：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·每次翻转屏幕都会重新请求一次——每次翻转屏幕用户都会看一会儿空白界面。
·如果用户经常翻转屏幕，就会导致内存泄露——每个回调都会保持对MainActivity的引用，并且request运行的时候会把MainActivity保持在内存中。这绝对有可能导致因为内存溢出而应用crash，或者应用运行明显缓慢。
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;使用MVP的例子01&quot;&gt;&lt;a href=&quot;#使用MVP的例子01&quot; class=&quot;headerlink&quot; title=&quot;使用MVP的例子01&quot;&gt;&lt;/a&gt;使用MVP的&lt;a href=&quot;https://github.com/konmik/MVPExamples/tree/master/example01&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;例子01&lt;/a&gt;&lt;/h2&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainPresenter&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String DEFAULT_NAME = &lt;span class=&quot;string&quot;&gt;&quot;Chuck Norris&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; ServerAPI.Item[] items;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; Throwable error;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; MainActivity view;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainPresenter&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        App.getServerAPI()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .getItems(DEFAULT_NAME.split(&lt;span class=&quot;string&quot;&gt;&quot;\\s+&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], DEFAULT_NAME.split(&lt;span class=&quot;string&quot;&gt;&quot;\\s+&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .delay(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, TimeUnit.SECONDS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .observeOn(AndroidSchedulers.mainThread())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .subscribe(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Action1&amp;lt;ServerAPI.Response&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ServerAPI.Response response)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    items = response.items;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    publish();&lt;span class=&quot;comment&quot;&gt;//onNext&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Action1&amp;lt;Throwable&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Throwable throwable)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    error = throwable;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    publish();&lt;span class=&quot;comment&quot;&gt;//onError&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onTakeView&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(MainActivity view)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.view = view;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        publish();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (view != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (items != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                view.onItemsNext(items);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (error != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                view.onItemsError(error);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从技术角度讲：MainPresenter有三个线程事件：onNext，onError，onTakeview。通过&lt;code&gt;publish()&lt;/code&gt;方法，onNext或者onError事件会发布到MainActivity实例。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Activity&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; ArrayAdapter&amp;lt;ServerAPI.Item&amp;gt; adapter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; MainPresenter presenter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setContentView(R.layout.activity_main);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ListView listView = (ListView)findViewById(R.id.listView);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        listView.setAdapter(adapter = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayAdapter&amp;lt;&amp;gt;(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, R.layout.item));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (presenter == &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            presenter = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; MainPresenter();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        presenter.onTakeView(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onDestroy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onDestroy();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        presenter.onTakeView(&lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isFinishing())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            presenter = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onItemsNext&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ServerAPI.Item[] items)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        adapter.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        adapter.addAll(items);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onItemsError&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Throwable throwable)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Toast.makeText(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, throwable.getMessage(), Toast.LENGTH_LONG).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;MainActivity 创建 MainPresenter，并且保持MainPresenter在onCreate和onDestory周期之外。MainActivity用一个静态变量引用MainPresenter，当由于OOM导致线程重启，MainActivity会检查MainPresenter是否还存在，如果不存在就去创建它。&lt;/p&gt;
&lt;p&gt;是的，检查和使用静态变量起来有那么点臃肿，但是稍后我会给大家看如何写的更加优雅。：）&lt;/p&gt;
&lt;p&gt;主要思想：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·例子应用不会在每次用户翻转屏幕的时候重新请求。
·如果线程被重启，再次加载数据。
·当MainActivity被销毁后，MainPresenter不会保持应用
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;MainActivity实例，这样当旋转屏幕的时候就不会内存泄露，而且也没有取消请求。&lt;/p&gt;
&lt;p&gt;##Nucleus&lt;/p&gt;
&lt;p&gt;Nuleus 是我创建的一个library，灵感来自于&lt;a href=&quot;https://github.com/square/mortar&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Mortar&lt;/a&gt;library和&lt;a href=&quot;https://people.apache.org/~fhanik/kiss.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Keep It Stupid Simple&lt;/a&gt;这篇文章。&lt;/p&gt;
&lt;p&gt;下面是功能列表：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·支持在View/Fragment/Activity状态Bundle中save/restore Presenter的状态。Presenter能够存储请求参数到重新启动。

·提供一个工具，通过一行代码可以把请求结果和错误放到正确的view当中去，因此无需再写`！=null`来检查。

·一个Presenter可以被多个view实例引用。如果Presenter实例使用[Dagger]，就不能被多个view引用。

·通过一行代码就可以把Presenter和view进行绑定。

·提供view的基类：NucleusView, NucleusFragment, NucleusSupportFragment, NucleusActivity。你也可以从他们当中copy代码到任何类当中来利用Nucleus的Presenters。

·Presenter在线程重启之后能够自动restart。在`onDestroy`自动取消注册RxJava。

·最后，要保持简单明了，让每一个开发者都能够看懂。这里通过大约180行代码来驱动Presenter，230行RxJava代码来支持。
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&quot;使用Nuleus的例子02&quot;&gt;&lt;a href=&quot;#使用Nuleus的例子02&quot; class=&quot;headerlink&quot; title=&quot;使用Nuleus的例子02&quot;&gt;&lt;/a&gt;使用&lt;a href=&quot;https://github.com/konmik/nucleus&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Nuleus&lt;/a&gt;的&lt;a href=&quot;https://github.com/konmik/MVPExamples/tree/master/example02&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;例子02&lt;/a&gt;&lt;/h2&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainPresenter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;RxPresenter&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; String DEFAULT_NAME = &lt;span class=&quot;string&quot;&gt;&quot;Chuck Norris&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Bundle savedState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        App.getServerAPI()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .getItems(DEFAULT_NAME.split(&lt;span class=&quot;string&quot;&gt;&quot;\\s+&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], DEFAULT_NAME.split(&lt;span class=&quot;string&quot;&gt;&quot;\\s+&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .delay(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, TimeUnit.SECONDS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .observeOn(AndroidSchedulers.mainThread())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .compose(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.&amp;lt;ServerAPI.Response&amp;gt;deliverLatestCache())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            .subscribe(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Action1&amp;lt;ServerAPI.Response&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ServerAPI.Response response)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    getView().onItemsNext(response.items);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Action1&amp;lt;Throwable&amp;gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Throwable throwable)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    getView().onItemsError(throwable);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@RequiresPresenter&lt;/span&gt;(MainPresenter.class)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;NucleusActivity&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;MainPresenter&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; ArrayAdapter&amp;lt;ServerAPI.Item&amp;gt; adapter;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Bundle savedInstanceState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedInstanceState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setContentView(R.layout.activity_main);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ListView listView = (ListView)findViewById(R.id.listView);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        listView.setAdapter(adapter = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayAdapter&amp;lt;&amp;gt;(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, R.layout.item));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onItemsNext&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(ServerAPI.Item[] items)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        adapter.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        adapter.addAll(items);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onItemsError&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Throwable throwable)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Toast.makeText(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, throwable.getMessage(), Toast.LENGTH_LONG).show();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;正如你看到的，这个例子明显比前一个例子短，并且简洁。Nucleus用来创建，销毁，保存Presenter， attache 或 detached一个view到Presenter，并且把请求结果自动发送到被 attache 的View当中。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MainPresenter&lt;/code&gt;的代码比较少是因为通过&lt;code&gt;deliverLatestCache()&lt;/code&gt;操作，期延迟了数据和错误，直到view是可用的，才会把数据和错误送到view里。它把数据缓存到内存中，这样当configuration改变的时候，数据还是可用的。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MainActivity&lt;/code&gt;的代码比较少是因为Presenter的创建由&lt;code&gt;NucleusActivity&lt;/code&gt;来管理。所有你需要绑定presenter的类，只需要在类上声明&lt;code&gt;@RequiresPresenter(MainPresenter.class)&lt;/code&gt;注释。&lt;/p&gt;
&lt;p&gt;警告！注释！在Android世界中，如果你使用注释，这是一个很好的做法，这不会降低性能。我已Galaxy S（2010的设备）作为基准测试，处理注释只会花去0.3ms。这种注视只会发生在view中，所以我认为注释是对系统性能没有消耗的。&lt;/p&gt;
&lt;p&gt;##更多例子&lt;/p&gt;
&lt;p&gt;这是一个参数持久性的&lt;a href=&quot;https://github.com/konmik/nucleus/tree/master/nucleus-example&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;例子&lt;/a&gt;。&lt;a href=&quot;https://github.com/konmik/nucleus/tree/master/nucleus-example-with-tests&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;测试列子&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&quot;deliverLatestCache-方法&quot;&gt;&lt;a href=&quot;#deliverLatestCache-方法&quot; class=&quot;headerlink&quot; title=&quot;deliverLatestCache()方法&quot;&gt;&lt;/a&gt;&lt;code&gt;deliverLatestCache()&lt;/code&gt;方法&lt;/h2&gt;&lt;p&gt;这是RxPresenter的一个方法，它有三种版本：&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;deliver()&lt;/code&gt;延迟onNext，onError和onComplete到view变成可用的才会释放。当你做一次请求的时候可以使用它，例如登录到web service。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/RxPresenter.html#deliver(&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;deliverLatest()&lt;/code&gt;如果有一个新的onNext可用，将会抛弃老的onNext。如果你有数据需要更新，这将不会积累没有必要的数据。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/RxPresenter.html#deliverLatest(&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;deliverLastestCache()&lt;/code&gt;和&lt;code&gt;deliverLatest()&lt;/code&gt;比较相似，它保存最后一次数据在内存中，当另一个view变成可用的（例如：configuration 改变），它将重新发送数据到view。如果你不想save/restore请求结果到你的view中（返回结果比较大或者不方便存储到Bundle中），这个方法将允许你去做出更好的用户体验。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/RxPresenter.html#deliverLatestCache(&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&quot;Presenter的生命周期&quot;&gt;&lt;a href=&quot;#Presenter的生命周期&quot; class=&quot;headerlink&quot; title=&quot;Presenter的生命周期&quot;&gt;&lt;/a&gt;Presenter的生命周期&lt;/h2&gt;&lt;p&gt;Presenter的生命周期与Android的控件相比，明显少一些。&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;void onCreate(Bundle savedState)&lt;/code&gt; - 当Presenter被创建的时候会被调用。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onCreate(android.os.Bundle&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;void onDestroy()&lt;/code&gt; - 离开view的时候会被调用。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onDestroy(&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;void onSave(Bundle state)&lt;/code&gt; - 当View的&lt;code&gt;onSaveInstanceState&lt;/code&gt;被调用时会调用，保持Presenter的状态。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onTakeView(ViewType&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;void onTakeView(ViewType view)&lt;/code&gt; -在Activity或者Fragment调用&lt;code&gt;onResume()&lt;/code&gt;，或者在&lt;code&gt;android.view.View#onAttachedToWindow()&lt;/code&gt;期间。 &lt;a href=&quot;http://konmik.github.io/attachenucleus/nucleus/presenter/Presenter.html#onTakeView(ViewType&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;·&lt;code&gt;void onDropView()&lt;/code&gt; - Activity或者Fragment调用&lt;code&gt;onPause()&lt;/code&gt;，或者在&lt;code&gt;android.view.View#onDetachedFromWindow()&lt;/code&gt;期间。&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onDropView(&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&quot;View回收和View栈&quot;&gt;&lt;a href=&quot;#View回收和View栈&quot; class=&quot;headerlink&quot; title=&quot;View回收和View栈&quot;&gt;&lt;/a&gt;View回收和View栈&lt;/h2&gt;&lt;p&gt;通常你的view（Fragment和自定义view）在与用户的交互下随机 attache 和 detached。每次view被 detached的时候不去销毁Presenter，这可能是一个好主意。你可以任何时间 detached和 attache view，presenter会比这些动作活的更持久，继续后台的工作。&lt;/p&gt;
&lt;p&gt;联想到view的回收，有个问题：fragment无法知道是否因为配置改变或者被弹出栈被 detached。&lt;/p&gt;
&lt;p&gt;Nucleus的意见是：销毁presenter只能发生在view的&lt;code&gt;onDetachedFromWindow()/onDestroy()&lt;/code&gt;并且activity是finish的。所以，如果你销毁view是在正常的activity生命周期，你可发出信号来通知presenter也应该被销毁。这里有两个方法可以用&lt;code&gt;NucleusLayout.destroyPresenter()&lt;/code&gt;和&lt;code&gt;NucleusFragment.destroyPresenter()&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;举个例子，下面是我在我的项目里面如何管理Fragment &lt;code&gt;pop()&lt;/code&gt;操作：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;fragment = fragmentManager.findFragmentById(R.id.fragmentStackContainer);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   fragmentManager.popBackStackImmediate();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (fragment &lt;span class=&quot;keyword&quot;&gt;instanceof&lt;/span&gt; NucleusFragment)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       ((NucleusFragment)fragment).destroyPresenter();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你可以对replace Fragment做类似的操作。压栈操作的时候也可以。&lt;/p&gt;
&lt;p&gt;每次view从Activity detached的时候，你可以决定去销毁presenter来避免这个问题，但是你也将在view被detach的时候失去后台任务。&lt;/p&gt;
&lt;p&gt;因此，view回收这部分，完全取决于你。也许，我会找到更好的解决方案，如果你知道，请告诉我。&lt;/p&gt;
&lt;h1 id=&quot;最佳实践&quot;&gt;&lt;a href=&quot;#最佳实践&quot; class=&quot;headerlink&quot; title=&quot;最佳实践&quot;&gt;&lt;/a&gt;最佳实践&lt;/h1&gt;&lt;h2 id=&quot;把你的请求参数放在Presenter里&quot;&gt;&lt;a href=&quot;#把你的请求参数放在Presenter里&quot; class=&quot;headerlink&quot; title=&quot;把你的请求参数放在Presenter里&quot;&gt;&lt;/a&gt;把你的请求参数放在Presenter里&lt;/h2&gt;&lt;p&gt;这个规则很简单：主要是为了管理请求。所以view自己不应该掌控和重启请求。从View的角度来看，后台任务，永远不会消失，不需要任何回调也会返回一个结果或错误。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainPresenter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;RxPresenter&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; String name = DEFAULT_NAME;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Bundle savedState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (savedState != &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            name = savedState.getString(NAME_KEY);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onSave&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(@NonNull Bundle state)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onSave(state);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        state.putString(NAME_KEY, name);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我建议使用&lt;a href=&quot;https://github.com/frankiesardo/icepick&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Icepick&lt;/a&gt;library。无需使用注解，就可以减少代码量，并且简化应用逻辑——这一切都发生在编译过程中。可以配合&lt;a href=&quot;http://jakewharton.github.io/butterknife&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ButterKnife&lt;/a&gt;使用。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MainPresenter&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;RxPresenter&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;MainActivity&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Icicle&lt;/span&gt; String name = DEFAULT_NAME;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Bundle savedState)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onCreate(savedState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Icepick.restoreInstanceState(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, savedState);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;onSave&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(@NonNull Bundle state)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.onSave(state);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Icepick.saveInstanceState(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, state);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果你有超过2个的请求参数，这个library会存储它们。你可以创建一个&lt;code&gt;BasePresenter&lt;/code&gt;，并且把Icepick放在类里，这样所有的子类将会获得&lt;code&gt;@Icicle&lt;/code&gt;，无需再次实现&lt;code&gt;onSave&lt;/code&gt;。这也工作在activity，Fragment和view。&lt;/p&gt;
&lt;h2 id=&quot;在onTakeView主线程中，执行一个即时查询Javadoc&quot;&gt;&lt;a href=&quot;#在onTakeView主线程中，执行一个即时查询Javadoc&quot; class=&quot;headerlink&quot; title=&quot;在onTakeView主线程中，执行一个即时查询Javadoc)&quot;&gt;&lt;/a&gt;在onTakeView主线程中，执行一个即时查询&lt;a href=&quot;http://konmik.github.io/nucleus/nucleus/presenter/Presenter.html#onTakeView(ViewType&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javadoc&lt;/a&gt;)&lt;/h2&gt;&lt;p&gt;有时候，你要查询一段小数据，例如从数据库中读取一小段数据。虽然你可以用Nucleus简单的创建一个请求，但是你不必到处使用Nucleus。如果在一个Fragment创建的过程中创建一个后台请求，用户会看到一个空白屏幕一小会儿，尽管这个请求就几毫秒。因此，为了是代码更简短，更友善，使用主线程吧。&lt;/p&gt;
&lt;h2 id=&quot;不要尝试用Presenter控制你的View&quot;&gt;&lt;a href=&quot;#不要尝试用Presenter控制你的View&quot; class=&quot;headerlink&quot; title=&quot;不要尝试用Presenter控制你的View&quot;&gt;&lt;/a&gt;不要尝试用Presenter控制你的View&lt;/h2&gt;&lt;p&gt;这么做不是个好方式——应用的逻辑会变得更复杂，这是不正常的方式。&lt;/p&gt;
&lt;p&gt;正常的方式是，控制流应该是从用户，通过View，到Presenter，再到Model。用户是控制应用程序的一个来源。因此我们的控制流应该是从用户开始，而不是从应用的内部的结构。&lt;/p&gt;
&lt;p&gt;当控制流是从View到Presenter，然后Presenter到Model，这是一个线性流，这样很好写代码。这样你得到了一个简单的序列，user-&amp;gt;view-&amp;gt;presenter-&amp;gt;model-&amp;gt;data。但是，当控制流是这个样子的：user-&amp;gt;view-&amp;gt;presenter-&amp;gt;view-&amp;gt;presenter-&amp;gt;model-&amp;gt;data，这只是违反了KISS原则。&lt;/p&gt;
&lt;p&gt;Fragment？是的，Fragment有时候会违反正常的控制流。他们太复杂了。这里有一篇不错的文章，关于思考Fragment：&lt;a href=&quot;http://corner.squareup.com/2014/10/advocating-against-android-fragments.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Advocating Against Android Fragments&lt;/a&gt;。但是&lt;a href=&quot;https://github.com/square/flow&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Flow&lt;/a&gt;也没有简化太多。&lt;/p&gt;
&lt;h2 id=&quot;MVC&quot;&gt;&lt;a href=&quot;#MVC&quot; class=&quot;headerlink&quot; title=&quot;MVC&quot;&gt;&lt;/a&gt;MVC&lt;/h2&gt;&lt;p&gt;如果你熟悉MVC，别用了。MVC完全不同于MVP，MVC并没有解决开发面临的问题。&lt;/p&gt;
&lt;p&gt;什么是MVC？&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;·Model应用内部的逻辑部分。负责数据存储。
·View唯一和MVP共同的部分，应用中呈现到屏幕的部分。
·Controller输入设备，例如键盘，鼠标，操纵杆。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当你有一台电脑和一个用键盘简单驱动的游戏的时候，MVC出现有很长一段时间了。没有windows，没有图形交互界面，应用程序接收输入（Controller），维持一些状态（Model），产生输出（View）。控制流是这样的：Controller-&amp;gt;Model-&amp;gt;View。这种模式绝对不能用在Android中。&lt;/p&gt;
&lt;p&gt;有很多混淆的MVC模式。人们相信他们使用的是MVC，实际上他们可能用的是MVP（Web开发）。很多Android开发，认为Controller就是控制View，因此他们尝试抽取View的逻辑代码来减少View的代码，用Controller来控制View。我个人没看到这种方式有任何好处。&lt;/p&gt;
&lt;h2 id=&quot;使用不可变数据结构的复杂关系数据库项目&quot;&gt;&lt;a href=&quot;#使用不可变数据结构的复杂关系数据库项目&quot; class=&quot;headerlink&quot; title=&quot;使用不可变数据结构的复杂关系数据库项目&quot;&gt;&lt;/a&gt;使用不可变数据结构的复杂关系数据库项目&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/google/auto/tree/master/value&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AutoValue&lt;/a&gt;是一个这样的library，在它的描述中写了一堆好处，我推荐看看它。&lt;a href=&quot;https://github.com/frankiesardo/auto-parcel&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AutoParcel&lt;/a&gt;是AutoValue一个Android项目。使用的主要原因是，不用改变对象，通过AutoParcel转换，而不用关心其影响了应用程序的其他部分。他们都是线程安全的。&lt;/p&gt;
&lt;h1 id=&quot;结尾&quot;&gt;&lt;a href=&quot;#结尾&quot; class=&quot;headerlink&quot; title=&quot;结尾&quot;&gt;&lt;/a&gt;结尾&lt;/h1&gt;&lt;p&gt;尝试MVP，并且分享给你的朋友。：）&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这篇文章是我学习MVP模式时翻译的，原文是&lt;a href=&quot;http://konmik.github.io/author/konstantin-mikheev.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Konstantin Mikheev&lt;/
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="MVP" scheme="http://kennethyo.me/tags/MVP/"/>
    
  </entry>
  
  <entry>
    <title>[原]Android获取运营商</title>
    <link href="http://kennethyo.me/2015/05/08/2015-05-08/"/>
    <id>http://kennethyo.me/2015/05/08/2015-05-08/</id>
    <published>2015-05-08T08:40:08.000Z</published>
    <updated>2016-09-01T06:39:08.000Z</updated>
    
    <content type="html">&lt;p&gt;今天接到一个新需求，要给服务器上送设备运营商名称，之后我的第一反应是，umeng都无法精确统计运营商，我如何判断上送具体的运营商呢？如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150508163804803&quot; alt=&quot;这里写图片描述&quot;&gt;&lt;/p&gt;
&lt;p&gt;这张图里反映了友盟统计到用户手机的运营商名称，这些名称什么样子的都有。有什么办法精确判断具体是什么运营商呢？比如，只返回“中国移动”，“中国联通”，“中国电信”。&lt;/p&gt;
&lt;p&gt;我这里解决的方案是通过设备的MCC/MNC代码来判断。&lt;/p&gt;
&lt;p&gt;首先，我们要了解MCC/MNC是什么，请看&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E7%A7%BB%E5%8A%A8%E8%AE%BE%E5%A4%87%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%A0%81&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;WIKI百科&lt;/a&gt;。通过阅读，我们能够知道，只要对比MCC/MNC编码，就能知道具体是什么运营商了。&lt;/p&gt;
&lt;p&gt;其次，就是具体代码了，如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;span class=&amp;quot;hljs-javadoc&amp;quot;&amp;gt;/**
     * 返回运营商 需要加入权限 &amp;amp;lt;uses-permission android:name=&amp;quot;android.permission.READ_PHONE_STATE&amp;quot;/&amp;amp;gt; &amp;amp;lt;BR&amp;amp;gt;
     *
     *&amp;lt;span class=&amp;quot;hljs-javadoctag&amp;quot;&amp;gt; @return&amp;lt;/span&amp;gt; 1,代表中国移动，2，代表中国联通，3，代表中国电信，0，代表未知
     *&amp;lt;span class=&amp;quot;hljs-javadoctag&amp;quot;&amp;gt; @author&amp;lt;/span&amp;gt; youzc@yiche.com
     */&amp;lt;/span&amp;gt;
 &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;public&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;int&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;getOperators&amp;lt;/span&amp;gt;(Context context) {
        &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// 移动设备网络代码（英语：Mobile Network Code，MNC）是与移动设备国家代码（Mobile Country Code，MCC）（也称为“MCC /&amp;lt;/span&amp;gt;
        &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// MNC”）相结合, 例如46000，前三位是MCC，后两位是MNC 获取手机服务商信息&amp;lt;/span&amp;gt;
        &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;int&amp;lt;/span&amp;gt; OperatorsName = &amp;lt;span class=&amp;quot;hljs-number&amp;quot;&amp;gt;0&amp;lt;/span&amp;gt;;
        String IMSI =  (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE).getSubscriberId();
        &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// IMSI号前面3位460是国家，紧接着后面2位00 运营商代码&amp;lt;/span&amp;gt;
        System.out.println(IMSI);
        &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46000&amp;quot;&amp;lt;/span&amp;gt;) || IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46002&amp;quot;&amp;lt;/span&amp;gt;) || IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46007&amp;quot;&amp;lt;/span&amp;gt;)) {
            OperatorsName = &amp;lt;span class=&amp;quot;hljs-number&amp;quot;&amp;gt;1&amp;lt;/span&amp;gt;;
        } &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;else&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46001&amp;quot;&amp;lt;/span&amp;gt;) || IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46006&amp;quot;&amp;lt;/span&amp;gt;)) {
            OperatorsName = &amp;lt;span class=&amp;quot;hljs-number&amp;quot;&amp;gt;2&amp;lt;/span&amp;gt;;
        } &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;else&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46003&amp;quot;&amp;lt;/span&amp;gt;) || IMSI.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;46005&amp;quot;&amp;lt;/span&amp;gt;)) {
            OperatorsName = &amp;lt;span class=&amp;quot;hljs-number&amp;quot;&amp;gt;3&amp;lt;/span&amp;gt;;
        }
        &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;return&amp;lt;/span&amp;gt; OperatorsName;
    }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;通过客户端本地比对MCC/MNC确定运营商这种方式，本身我是不赞同的，我认为把MCC/MNC上送到服务器，由服务器判断这才是最优方案。因为应用打好包分发出去，代码就是死的，未来不可以扩展比对，但是服务器是可以动态的，随时配置比对的MCC/MNC编码。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2015/5/8 16:40:08 [原文链接](http://blog.csdn.net/kennethyo/article/details/45582153)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：814 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/45582153#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;今天接到一个新需求，要给服务器上送设备运营商名称，之后我的第一反应是，umeng都无法精确统计运营商，我如何判断上送具体的运营商呢？如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150508163804803&quot; alt=&quot;
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[原]WebView填坑——小功能篇</title>
    <link href="http://kennethyo.me/2015/04/22/%E5%8E%9F-WebView%E5%A1%AB%E5%9D%91%E2%80%94%E2%80%94%E5%B0%8F%E5%8A%9F%E8%83%BD%E7%AF%87/"/>
    <id>http://kennethyo.me/2015/04/22/原-WebView填坑——小功能篇/</id>
    <published>2015-04-22T08:31:06.000Z</published>
    <updated>2016-06-08T06:46:36.000Z</updated>
    
    <content type="html">&lt;p&gt;这两天负责修改了几个关于在webview中打开公司移动站的bug。本身不是很难解，网上查查都有，但是也有必要记录下来作为备忘。&lt;/p&gt;
&lt;h3 id=&quot;Webview中上传文件&quot;&gt;&lt;a href=&quot;#Webview中上传文件&quot; class=&quot;headerlink&quot; title=&quot;Webview中上传文件&quot;&gt;&lt;/a&gt;Webview中上传文件&lt;/h3&gt;&lt;p&gt;这里的效果类似在pc端上传文件效果，点击打开一个文件选择器，上传文件图片之类的。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;openFileChooser（）&lt;/code&gt;方法的重载是因为在不同系统中调用的方法参数不一样，具体看注释。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ValueCallback&amp;amp;lt;Uri&amp;amp;gt; mUploadMessage&lt;/code&gt;作为成员变量的目的是我们要在打开的系统文件选择器&lt;code&gt;finish()&lt;/code&gt;后在&lt;code&gt;onActivityResult()&lt;/code&gt;时调用。&lt;/p&gt;
&lt;p&gt;具体实现代码如下：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;private&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;void&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;initWebView&amp;lt;/span&amp;gt;(){
    webView.setWebChromeClient(&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;new&amp;lt;/span&amp;gt; MyWebChromeClient());
}

 &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;private&amp;lt;/span&amp;gt; ValueCallback&amp;amp;lt;Uri&amp;amp;gt; mUploadMessage;
&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;private&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-class&amp;quot;&amp;gt;&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;class&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;MyWebChromeClient&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;extends&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;WebChromeClient&amp;lt;/span&amp;gt; {&amp;lt;/span&amp;gt;

    &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// js上传文件的&amp;amp;lt;input type=&amp;quot;file&amp;quot; /&amp;amp;gt;事件捕获&amp;lt;/span&amp;gt;
    &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// Android &amp;amp;gt; 4.1.1 调用这个方法&amp;lt;/span&amp;gt;
    &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;public&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;void&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;openFileChooser&amp;lt;/span&amp;gt;(ValueCallback&amp;amp;lt;Uri&amp;amp;gt; uploadMsg, String acceptType, String capture) {
      mUploadMessage = uploadMsg;

      Intent intent = &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;new&amp;lt;/span&amp;gt; Intent(Intent.ACTION_GET_CONTENT);
      intent.addCategory(Intent.CATEGORY_OPENABLE);
      intent.setType(TextUtils.isEmpty(acceptType) ? &amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;image/*&amp;quot;&amp;lt;/span&amp;gt; : acceptType);

      MobileSiteActivity.&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;this&amp;lt;/span&amp;gt;.startActivityForResult(
          Intent.createChooser(intent, ToolBox.getString(R.string.web_activity_please_chooser)),
          MobileSiteActivity.FILECHOOSER_RESULTCODE);

    }

    &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// 3.0 + 调用这个方法&amp;lt;/span&amp;gt;
    &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;public&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;void&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;openFileChooser&amp;lt;/span&amp;gt;(ValueCallback&amp;amp;lt;Uri&amp;amp;gt; uploadMsg, String acceptType) {
      openFileChooser(uploadMsg, acceptType, &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt;);
    }

    &amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// Android &amp;amp;lt; 3.0 调用这个方法&amp;lt;/span&amp;gt;
    &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;public&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;void&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;openFileChooser&amp;lt;/span&amp;gt;(ValueCallback&amp;amp;lt;Uri&amp;amp;gt; uploadMsg) {
      openFileChooser(uploadMsg, &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt;);
    }
  }
  &amp;lt;span class=&amp;quot;hljs-annotation&amp;quot;&amp;gt;@Override&amp;lt;/span&amp;gt;
  &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;protected&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;void&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;onActivityResult&amp;lt;/span&amp;gt;(&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;int&amp;lt;/span&amp;gt; requestCode, &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;int&amp;lt;/span&amp;gt; resultCode, Intent data) {
    &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (FILECHOOSER_RESULTCODE == requestCode) {
      &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt; == mUploadMessage) &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;return&amp;lt;/span&amp;gt;;
      Uri result = data == &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt; || resultCode != RESULT_OK ? &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt; : data.getData();
      mUploadMessage.onReceiveValue(result);
      mUploadMessage = &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt;;
      &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;return&amp;lt;/span&amp;gt;;
    }
  }
`&amp;lt;/pre&amp;gt;

### WebView当中网页中的地图为白色，不显示地图

这个问题其实就是你没有打开Javascript支持。打开就好啦~

&amp;lt;pre class=&amp;quot;prettyprint&amp;quot;&amp;gt;`webView.setJavaScriptEnabled(&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;true&amp;lt;/span&amp;gt;);&amp;lt;span class=&amp;quot;hljs-comment&amp;quot;&amp;gt;// 设置支持javascript脚本&amp;lt;/span&amp;gt;`&amp;lt;/pre&amp;gt;

### WebView中跳转系统拨号键盘

举一反三，既然要打开系统拨号键盘，那邮箱，地图也可以支持。

&amp;lt;pre class=&amp;quot;prettyprint&amp;quot;&amp;gt;`webView.setWebViewClient(&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;new&amp;lt;/span&amp;gt; WebViewClient() {
      &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;public&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;boolean&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;shouldOverrideUrlLoading&amp;lt;/span&amp;gt;(WebView view, String url) {

        &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (url.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;mailto:&amp;quot;&amp;lt;/span&amp;gt;) || url.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;geo:&amp;quot;&amp;lt;/span&amp;gt;) || url.startsWith(&amp;lt;span class=&amp;quot;hljs-string&amp;quot;&amp;gt;&amp;quot;tel:&amp;quot;&amp;lt;/span&amp;gt;)) {
          Intent intent = &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;new&amp;lt;/span&amp;gt; Intent(Intent.ACTION_VIEW, Uri.parse(url));
          startActivity(intent);
          &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;return&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;true&amp;lt;/span&amp;gt;;
        }
        view.loadUrl(url);
        &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;return&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;true&amp;lt;/span&amp;gt;;
      }
    });`&amp;lt;/pre&amp;gt;

### WebView中支持下载

这里要给WebView设置一个下载监听，监听会回调给你下载地址，这里可以打开系统浏览器去激活下载，用DownloadManger直接去下载也可以，我选择的是第一种方式，这种方式我认为比较符合用户习惯哈。

&amp;lt;pre class=&amp;quot;prettyprint&amp;quot;&amp;gt;` webView.setDownloadListener(&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;new&amp;lt;/span&amp;gt; MyWebViewDownLoadListener());`&amp;lt;/pre&amp;gt;

&amp;lt;pre class=&amp;quot;prettyprint&amp;quot;&amp;gt;`
 &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;private&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-class&amp;quot;&amp;gt;&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;class&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;MyWebViewDownLoadListener&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;implements&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;DownloadListener&amp;lt;/span&amp;gt; {&amp;lt;/span&amp;gt;

    &amp;lt;span class=&amp;quot;hljs-annotation&amp;quot;&amp;gt;@Override&amp;lt;/span&amp;gt;
    &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;public&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;void&amp;lt;/span&amp;gt; &amp;lt;span class=&amp;quot;hljs-title&amp;quot;&amp;gt;onDownloadStart&amp;lt;/span&amp;gt;(String url, String userAgent, String contentDisposition,
        String mimetype, &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;long&amp;lt;/span&amp;gt; contentLength) {

      &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;if&amp;lt;/span&amp;gt; (&amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;null&amp;lt;/span&amp;gt; != url) {
        Uri uri = Uri.parse(url);
        Intent intent = &amp;lt;span class=&amp;quot;hljs-keyword&amp;quot;&amp;gt;new&amp;lt;/span&amp;gt; Intent(Intent.ACTION_VIEW, uri);
        startActivity(intent);
      }
    }

  }

        &amp;lt;div&amp;gt;
            作者：zh08070005 发表于2015/4/22 16:31:06 [原文链接](http://blog.csdn.net/kennethyo/article/details/45196891)
        &amp;lt;/div&amp;gt;
        &amp;lt;div&amp;gt;
        阅读：521 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/45196891#comments)
        &amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;这两天负责修改了几个关于在webview中打开公司移动站的bug。本身不是很难解，网上查查都有，但是也有必要记录下来作为备忘。&lt;/p&gt;
&lt;h3 id=&quot;Webview中上传文件&quot;&gt;&lt;a href=&quot;#Webview中上传文件&quot; class=&quot;headerlink&quot; titl
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[原]Android程序猿如何泡设计妹之快速掌握dp和px才可以</title>
    <link href="http://kennethyo.me/2015/01/25/2015-01-25/"/>
    <id>http://kennethyo.me/2015/01/25/2015-01-25/</id>
    <published>2015-01-25T14:44:22.000Z</published>
    <updated>2016-09-01T06:35:53.000Z</updated>
    
    <content type="html">&lt;p&gt;相信很多Android程序猿已经对身边的设计妹垂涎三尺了，那么如何博得设计妹的好感呢，学好这篇文章就可以了。&lt;/p&gt;
&lt;p&gt;程序猿与UI设计妹讨论设计稿和切图的时候，经常会因为dp和px的问题搞的不愉快，这里可以分析出两个原因：&lt;/p&gt;
&lt;p&gt;1，程序猿原因，不懂dp和px的换算关系。包括我，以及我见到的大多数开发，更多的时候其实不是很关心dp和px是如何来的，以及如何转换的，只知道掌握一般情况用dp，字体大小用sp，画线用px。&lt;/p&gt;
&lt;p&gt;2，设计妹原因，设计不出dp标注，或者甚至就不懂dp是什么东东。大多数公司并不会为Android专门做一套设计稿，只会出一版iOS设计稿，而iOS的设计稿都是用px去标注的，又因为上面的第一个原因，Android程序猿也搞不明白标注的px应该用多少dp。&lt;/p&gt;
&lt;p&gt;下面我们就用简单的方式去增进程序猿和设计妹感情吧！&lt;/p&gt;
&lt;p&gt;首先，我们要了解这张图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150125224509843?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这里面列举了目前Android开发常见的5种dpi，dpi是指每英寸的像素（例如：一个宽是1.5英寸240像素，高是2英寸320像素的手机的dpi是：240px/1.5in=320px/2in=160dpi，既对角线上的每英寸的像素），上面这张表里还少一种，就是LDPI，是MDPI的0.75倍，也就是120DPI。&lt;/p&gt;
&lt;p&gt;下面这张图是各种dpi对应的主流手机屏幕：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150125224550469?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;请按照图中下方的公式，分别计算一下屏幕dpi。在mdpi中，dp/pixel = DPI/160，即1dip等价于DPI为160的设备中的1个像素点。那么在xhdpi 320dpi中，就是1dp等价于2像素（再次强调，一定用计算器算一算啊，还有dpi是对角线上的像素密度）。&lt;/p&gt;
&lt;p&gt;一般情况设计妹出的图会是xhdpi，既能照顾iOS，又会照顾到Android。既然是xhdpi，我们就可以用1dp=2px来应对设计妹的标注。如果不是xhdpi的图，你也可以按照这个0.75:1:1.5:2:3:4这个比例去换算一下。&lt;/p&gt;
&lt;p&gt;帮到这里了，剩下的还得看你的修为了。&lt;/p&gt;
&lt;p&gt;下面我再给出几个常用的&amp;#20540;：&lt;/p&gt;
&lt;p&gt;Launcher icon：48dp*48dp&lt;/p&gt;
&lt;p&gt;Action bar icons：32dp*32dp&lt;/p&gt;
&lt;p&gt;Small icons：16dp*16dp&lt;/p&gt;
&lt;p&gt;Notification icons：24dp*24dp&lt;/p&gt;
&lt;p&gt;如果这些你还不满意，再给你来张图，包你满意：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150125224602388?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;内容参考与网络和&lt;a href=&quot;http://developer.android.com/guide/practices/screens_support.html#range&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Android.com&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;如果打不开的话请看这里&lt;a href=&quot;http://www.kennethyo.me/post/category/cheng-xu-yuan-de-wu-qi-zhi-vpn&quot;&gt;《程序员的武器之一VPN》&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2015/1/25 22:44:22 [原文链接](http://blog.csdn.net/kennethyo/article/details/43123731)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：1117 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/43123731#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;相信很多Android程序猿已经对身边的设计妹垂涎三尺了，那么如何博得设计妹的好感呢，学好这篇文章就可以了。&lt;/p&gt;
&lt;p&gt;程序猿与UI设计妹讨论设计稿和切图的时候，经常会因为dp和px的问题搞的不愉快，这里可以分析出两个原因：&lt;/p&gt;
&lt;p&gt;1，程序猿原因，不懂dp和px
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[原]CardView初级使用</title>
    <link href="http://kennethyo.me/2014/12/28/2014-12-28/"/>
    <id>http://kennethyo.me/2014/12/28/2014-12-28/</id>
    <published>2014-12-28T06:08:54.000Z</published>
    <updated>2016-09-01T06:35:27.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;code&gt;CardView&lt;/code&gt;发布于android sdk v7的支持包中，具体如何将项目加入v7包，请看这里&lt;a href=&quot;http://kennethyo.farbox.com/post/android/recyclerviewchu-ji-shi-yong#main&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;传送门&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;卡片化是全新的Material风&amp;#26684;设计中重要的组成部分之一，卡片设计适合重要信息的展示，以及在list中作为一个包含有复杂操作的item使用。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;CardView&lt;/code&gt;继承于&lt;code&gt;Framelayout&lt;/code&gt;，比&lt;code&gt;FrameLayout&lt;/code&gt;多了3个重要的属性，&lt;code&gt;card_view:cardElevation&lt;/code&gt;，&lt;code&gt;card_view:cardCornerRadius&lt;/code&gt;，&lt;code&gt;card_view:cardBackgroundColor&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;card_view:cardElevation&lt;/code&gt;，可以设置卡片的阴影，可以使&lt;code&gt;CardView&lt;/code&gt;在z轴方向上有一种抬升的视觉效果，能给用户一种这里是重要信息的视觉感受。对应代码里的方法&lt;code&gt;public
 void setCardElevation (float radius)&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;card_view:cardCornerRadius&lt;/code&gt;，显然就是设置&lt;code&gt;CardView&lt;/code&gt;的圆角了。对应代码里的方法&lt;code&gt;public
 void setRadius (float radius)&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;card_view:cardBackgroundColor&lt;/code&gt;，设置&lt;code&gt;CardView&lt;/code&gt;的背景颜色，这个属性是不会影响阴影&lt;code&gt;card_view:cardElevation&lt;/code&gt;的效果的。对应代码里的方法&lt;code&gt;public
 void setCardBackgroundColor (int color)&lt;/code&gt;。&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;android.support.v7.widget.CardView&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@&amp;#43;id/cardview&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;fill_parent&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;card_view:cardElevation=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;100dp&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;card_view:cardBackgroundColor=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@color/grey&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;card_view:cardCornerRadius=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;8dp&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_marginLeft=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@dimen/margin&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_marginRight=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@dimen/margin&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;TextView&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_margin=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@dimen/margin&amp;quot;&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:text=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;这里是CardView&amp;quot;&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;/android.support.v7.widget.CardView&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;这里贴一个Android官方给的&lt;a href=&quot;https://github.com/googlesamples/android-CardView&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;sample&lt;/a&gt;吧!&lt;/p&gt;
&lt;p&gt;—————————————&lt;/p&gt;
&lt;p&gt;从11月19日开始一直在加班，把大把的时间都用于了我们岁末版本的开发上，这期间规划了好几篇想要写的博文，慢慢会发出来的，主要还是偏于介绍新控件的使用，以及如何兼容lollipop以下版本进行material风&amp;#26684;的设计，material风&amp;#26684;设计也将会是我所在项目组15年第一季度android的全新设计方案。&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;color:rgb(221,17,68); font-family:Inconsolata,monospace,sans-serif; line-height:30px; white-space:pre-wrap; background-color:rgb(247,247,249)&quot;&gt;（转载请注明出处：&lt;a href=&quot;http://kennethyo.farbox.com/post/android/2014-12-28）&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://kennethyo.farbox.com/post/android/2014-12-28）&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2014/12/28 14:08:54 [原文链接](http://blog.csdn.net/kennethyo/article/details/42213525)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：2090 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/42213525#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;CardView&lt;/code&gt;发布于android sdk v7的支持包中，具体如何将项目加入v7包，请看这里&lt;a href=&quot;http://kennethyo.farbox.com/post/android/recyclerviewchu-ji-shi-yon
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
      <category term="View" scheme="http://kennethyo.me/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>[原]RecyclerView初级使用</title>
    <link href="http://kennethyo.me/2014/11/10/2014-11-10/"/>
    <id>http://kennethyo.me/2014/11/10/2014-11-10/</id>
    <published>2014-11-10T07:18:15.000Z</published>
    <updated>2016-09-01T06:35:08.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;span style=&quot;font-family:Inconsolata,monospace,sans-serif; font-size:12px; color:#dd1144&quot;&gt;&lt;span style=&quot;white-space:pre-wrap; background-color:rgb(247,247,249)&quot;&gt;（转载请注明出处：&lt;a href=&quot;http://www.kennethyo.me/post/android/recyclerviewchu-ji-shi-yong）&quot;&gt;http://www.kennethyo.me/post/android/recyclerviewchu-ji-shi-yong）&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;RecyclerView&lt;/code&gt;是Android在v7包中包含了一个新的widget，&lt;code&gt;RecyclerView&lt;/code&gt;是一个&lt;code&gt;ListView&lt;/code&gt;进阶版，但不继承与&lt;code&gt;AdapterView&lt;/code&gt;，相比&lt;code&gt;ListView&lt;/code&gt;，&lt;code&gt;RecyclerView&lt;/code&gt;更加灵活和先进。&lt;/p&gt;
&lt;p&gt;##&lt;br&gt;1，导入RecyclerView&lt;/p&gt;
&lt;p&gt;首先要保证&lt;code&gt;SDK Tools&lt;/code&gt;和&lt;code&gt;Android
 Support Repository&lt;/code&gt;为最新版。如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141110151947150?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141110152010581?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;其次，在你的demo工程里选中Project Structure按钮，并且选择app —— Dependencies —— “&amp;#43;” —— Library dependency，去添加支持包，如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141110152138031?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;最后，在新的对话框里选中&lt;code&gt;com.android.support:recyclerview-v7:21.0.0&lt;/code&gt;，点击OK。如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141110152155781?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这里就顺利的导入了&lt;code&gt;RecyclerView&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;##&lt;br&gt;2，使用&lt;code&gt;RecyclerView&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在布局文件中使用&lt;code&gt;RecyclerView&lt;/code&gt;，跟其他自定义控件一样，如下：&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;RelativeLayout&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;xmlns:android=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;&lt;a href=&quot;http://schemas.android.com/apk/res/android&amp;amp;quot&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://schemas.android.com/apk/res/android&amp;amp;quot&lt;/a&gt;;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;xmlns:tools=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;&lt;a href=&quot;http://schemas.android.com/tools&amp;amp;quot&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://schemas.android.com/tools&amp;amp;quot&lt;/a&gt;;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;tools:context=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;.MainActivity&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;android.support.v7.widget.RecyclerView&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@&amp;#43;id/recyclerView&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;/RelativeLayout&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;因为日常开发中，我们大多数都是按照UI去布局每个item，所以这里我没与图省事用Android自带的布局。如下：&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;cp&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;LinearLayout&lt;/span&gt; &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;xmlns:android=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;&lt;a href=&quot;http://schemas.android.com/apk/res/android&amp;amp;quot&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://schemas.android.com/apk/res/android&amp;amp;quot&lt;/a&gt;;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;TextView&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:id=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@&amp;#43;id/textView&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_width=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:layout_height=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;48dp&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:textStyle=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;bold&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:background=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@android:color/holo_blue_light&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:textColor=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@android:color/holo_red_light&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:gravity=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;center_vertical&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:paddingLeft=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;@dimen/activity_horizontal_margin&amp;quot;&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;android:text=&lt;/span&gt;&lt;span class=&quot;s&quot; style=&quot;color:rgb(204,147,147)&quot;&gt;&amp;quot;New Text&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&quot;nt&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;&amp;lt;/LinearLayout&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;下面就是代码了：&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;nd&quot; style=&quot;color:rgb(204,204,204)&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Bundle&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;setContentView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;activity_main&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;recyclerView&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;RecyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;recyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//LinearLayoutManager可以自定义实现不同的动画效果和布局效果&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//这里设置为LinearLayoutManager.HORIZONTAL变成为了一个可以横向滑动的ListView，赞不赞？&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;LinearLayoutManager&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;layoutManager&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;LinearLayoutManager&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;LinearLayoutManager&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;VERTICAL&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot; style=&quot;color:rgb(220,163,163)&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;recyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setLayoutManager&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;layoutManager&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;recyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setHasFixedSize&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot; style=&quot;color:rgb(220,163,163)&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//adapter的改变不会改变RecyclerView的大小&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;];&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;&amp;#43;&amp;#43;){&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;valueOf&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;StringRecyclerAdapter&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;adapter&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;StringRecyclerAdapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;recyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setAdapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;adapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;可以明确看到的是，&lt;code&gt;RecyclerView&lt;/code&gt;通过&lt;code&gt;(RecyclerView)
 findViewById(R.id.recyclerView)&lt;/code&gt;初始化之后，不仅要像&lt;code&gt;ListView&lt;/code&gt;一样要放入&lt;code&gt;Adapter&lt;/code&gt;进行数据和布局的适配，而且还要额外添加一个&lt;code&gt;LinearLayoutManager&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;这个Manager就是我们的布局管理工具类，这里不仅可以用常规的竖直方向布局，还有横向的滑动的布局，以后再也不会因为没有横向滑动的&lt;code&gt;ListView&lt;/code&gt;去头疼自定义了。&lt;/p&gt;
&lt;p&gt;通过自定义&lt;code&gt;LinearLayoutManager&lt;/code&gt;也可以实现不同的动画效果，和移动效果。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;RecyclerView&lt;/code&gt;的Adapter和&lt;code&gt;ListView&lt;/code&gt;的Adapter也是不同的，&lt;code&gt;RecyclerView&lt;/code&gt;的Adapter要继承&lt;code&gt;RecyclerView.Adapter&amp;amp;lt;VH
 extends ViewHolder&amp;amp;gt;&lt;/code&gt;,并且&lt;code&gt;ViewHolder&lt;/code&gt;要继承与&lt;code&gt;ViewHolder.RecyclerView&lt;/code&gt;，具体代码如下：&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;StringRecyclerAdapter&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;RecyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;Adapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;StringRecyclerAdapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;ViewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;StringRecyclerAdapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;strings&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;nd&quot; style=&quot;color:rgb(204,204,204)&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;ViewHolder&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;onCreateViewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;ViewGroup&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;viewGroup&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;View&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;inflate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;viewGroup&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;layout&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;adapter_string_recylcer&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;color:rgb(220,163,163)&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;       &lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//这里发现不给item布局添加LayoutParams，会直接默认为WRAP_CONTENT，WRAP_CONTENT布局。&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setPadding&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setFocusable&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot; style=&quot;color:rgb(220,163,163)&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;RecyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;LayoutParams&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;lp&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;RecyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;LayoutParams&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;ViewGroup&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;LayoutParams&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;MATCH_PARENT&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt;&lt;br&gt;                &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;ViewGroup&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;LayoutParams&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;WRAP_CONTENT&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;lp&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;leftMargin&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;lp&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;rightMargin&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;lp&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;topMargin&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;lp&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;bottomMargin&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setLayoutParams&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;lp&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;ViewHolder&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;viewHolder&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;ViewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;viewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;nd&quot; style=&quot;color:rgb(204,204,204)&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;onBindViewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;ViewHolder&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;viewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;viewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;textView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setText&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;StringRecyclerAdapter&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getSimpleName&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;&amp;#43;&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;getValueAt&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;));&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;getValueAt&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;];&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;nd&quot; style=&quot;color:rgb(204,204,204)&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;getItemCount&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;strings&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot; style=&quot;color:rgb(220,163,163)&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot; style=&quot;color:rgb(140,208,211)&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;strings&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;    &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;ViewHolder&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;RecyclerView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;ViewHolder&lt;/span&gt; &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;View&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;OnClickListener&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;textView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;;&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;ViewHolder&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;itemView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;itemView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;textView&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;itemView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;textView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//因为RecyclerView没用setOnItemClickListener，所以在这里实现了点击事件&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//况且，现在有越来越多的设计，会在每个item点击不同位置，有不同的响应&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;textView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setOnClickListener&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;br&gt;        &lt;span class=&quot;nd&quot; style=&quot;color:rgb(204,204,204)&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;onClick&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;makeText&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(),((&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getText&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;LENGTH_SHORT&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;在&lt;code&gt;onCreateViewHolder&lt;/code&gt;方法中，我们需要把加载布局和&lt;code&gt;ViewHolder&lt;/code&gt;绑定起来，这里有个问题，不知道是Android的bug，还是故意这么设计的，需要我们主动写代码给item设置&lt;code&gt;LayoutParams&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;onBindViewHolder&lt;/code&gt;中负责数据绑定。&lt;/p&gt;
&lt;p&gt;这里有一个问题，&lt;code&gt;RecyclerView&lt;/code&gt;没有&lt;code&gt;setOnItemClickListener&lt;/code&gt;方法，所以我在里面对&lt;code&gt;TextView&lt;/code&gt;添加了点击事件，现在有越来越多的设计，会在每个item点击不同位置，有不同的响应。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141110152225296?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/KennethYo/RecyclerViewDemo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Demo链接&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2014/11/10 15:18:15 [原文链接](http://blog.csdn.net/kennethyo/article/details/40981263)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：1221 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/40981263#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;span style=&quot;font-family:Inconsolata,monospace,sans-serif; font-size:12px; color:#dd1144&quot;&gt;&lt;span style=&quot;white-space:pre-wrap; background-c
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[原]Palette的使用</title>
    <link href="http://kennethyo.me/2014/11/04/2014-11-04/"/>
    <id>http://kennethyo.me/2014/11/04/2014-11-04/</id>
    <published>2014-11-04T08:19:53.000Z</published>
    <updated>2016-09-01T06:34:47.000Z</updated>
    
    <content type="html">&lt;p&gt;（转载，请注明出处：&lt;a href=&quot;http://www.kennethyo.me/post/android/palettechu-ji-shi-yong&quot;&gt;http://www.kennethyo.me/post/android/palettechu-ji-shi-yong&lt;/a&gt;）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;相信有不少的人已经开始关注Android Lollipop，全新的Material设计风&amp;#26684;让人&amp;#30524;前一亮，Material强调大胆的阴影和高亮搭配，引用那些意料之外和充满活力的颜色。&lt;/p&gt;
&lt;p&gt;这里就要说到，不久前Android在v7包中更新的&lt;a href=&quot;http://developer.android.com/reference/android/support/v7/graphics/Palette.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Palette&lt;/a&gt;。Palette可以让我们构造色彩鲜艳的界面更加方便，通过一个图片的&lt;code&gt;bitmap&lt;/code&gt;来获取图片当中明暗对比的颜色。&lt;/p&gt;
&lt;p&gt;###&lt;br&gt;初始化Palette&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Palette&lt;/code&gt;通过一个静态方法进行初始化，并且需要传入一个&lt;code&gt;bitmap&lt;/code&gt;，这个&lt;code&gt;bitmap&lt;/code&gt;是我们要获取颜色图片的位图。&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Palette&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;bitmap&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;还有一个异步方法：&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//提供了一个异步方法&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;generateAsync&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;bitmap&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot; style=&quot;color:rgb(240,223,175)&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;PaletteAsyncListener&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;nd&quot; style=&quot;color:rgb(204,204,204)&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;kd&quot; style=&quot;color:rgb(255,255,134)&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot; style=&quot;color:rgb(0,205,0)&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot; style=&quot;color:rgb(239,239,143)&quot;&gt;onGenerated&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;Palette&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;{&lt;/span&gt;&lt;br&gt;            &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;});&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;###&lt;br&gt;获取&lt;code&gt;Palette.Swatch&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;通过以下几种方法获取相应的&lt;code&gt;Palette.Swatch&lt;/code&gt;，&lt;code&gt;Palette.Swatch&lt;/code&gt;是包含我们获取到颜色的一个载体&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getLightVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getLightMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getDarkVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getDarkMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;###&lt;br&gt;通过&lt;code&gt;Palette.Swatch&lt;/code&gt;获取到颜色&lt;/p&gt;
&lt;p&gt;针对Android，&lt;code&gt;Palette.Swatch.getRgb()&lt;/code&gt;返回一个&lt;code&gt;int&lt;/code&gt;RGB颜色&amp;#20540;。例如如下的用法：&lt;/p&gt;
&lt;div class=&quot;codehilite&quot; style=&quot;color:rgb(102,102,102); font-family:Helvetica,arial,&#39;Hiragino Sans GB&#39;,&#39;Microsoft Yahei&#39;,Verdana,Arial,sans-serif; font-size:15px; line-height:30px; background-color:rgb(253,253,253)&quot;&gt;&lt;br&gt;&lt;pre style=&quot;margin-top:1.6em; margin-bottom:1.6em; border:1px solid rgb(227,237,243); width:910px; padding:10px; font-family:Inconsolata,monospace,sans-serif; font-size:0.9em; overflow:auto; word-break:break-word; color:rgb(253,206,147); background:rgb(63,63,63)&quot;&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv1&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;tv1&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个活力的颜色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv1&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setTextColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getRgb&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个柔和的颜色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv1&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setBackgroundColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getRgb&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv2&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;tv2&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个活力的亮色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv2&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setTextColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getLightVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getRgb&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个柔和的亮色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv2&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setBackgroundColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getLightMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getRgb&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv3&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;tv3&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个活力的暗色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv3&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setTextColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getDarkVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getRgb&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个柔和的暗色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv3&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setBackgroundColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getDarkMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getRgb&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv4&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;TextView&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;findViewById&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;tv4&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个适合做标题的颜色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv4&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setTextColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getVibrantSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getTitleTextColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;c1&quot; style=&quot;color:rgb(127,159,127)&quot;&gt;//返回一个适合做主题的颜色&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;tv4&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;setBackgroundColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot; style=&quot;color:rgb(220,220,204)&quot;&gt;palette&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getDarkMutedSwatch&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot; style=&quot;color:rgb(154,195,159)&quot;&gt;getBodyTextColor&lt;/span&gt;&lt;span class=&quot;o&quot; style=&quot;color:rgb(240,239,208)&quot;&gt;());&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;br&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141105134308933?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;总体上看，Palette的使用简单，没有复杂的方法，更方便我们针对material风&amp;#26684;进行开发。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/KennethYo/PaletteDemo/tree/master&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;demo地址&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2014/11/4 16:19:53 [原文链接](http://blog.csdn.net/kennethyo/article/details/40786685)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：692 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/40786685#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;（转载，请注明出处：&lt;a href=&quot;http://www.kennethyo.me/post/android/palettechu-ji-shi-yong&quot;&gt;http://www.kennethyo.me/post/android/palettechu-ji-shi-yo
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[原]LayoutInflater.inflate详解</title>
    <link href="http://kennethyo.me/2014/10/24/2014-10-24/"/>
    <id>http://kennethyo.me/2014/10/24/2014-10-24/</id>
    <published>2014-10-24T08:27:08.000Z</published>
    <updated>2016-09-01T06:34:26.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;介绍常见inflate方法&quot;&gt;&lt;a href=&quot;#介绍常见inflate方法&quot; class=&quot;headerlink&quot; title=&quot;介绍常见inflate方法&quot;&gt;&lt;/a&gt;介绍常见inflate方法&lt;/h2&gt;&lt;p&gt;在日常开发中经常会用到通过资源id去获取view的场景，我们通常有四种方式去获取view，分别是以下四种：&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_1_2164263&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;//1,通过系统服务获取布局加载器
LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);

View view = inflater.inflate(resource,root,attachToRoot);

//2,通过activity中的getLayoutInflater()方法
View view = getLayoutInflater().inflate(resource,root,attachToRoot);

//3,通过View的静态inflate()方法
View view = View.inflate(resource,root,attachToRoot);

//4,通过LayoutInflater的inflate()方法
View view = LayoutInflater.from(this).inflate(resource,root,attachToRoot);
&lt;/pre&gt;

&lt;p&gt;通过对上述方法的源码的分析，很容易看出来这些方法都是最终调用了方式1，获取系统布局加载器的方式，来进行获取&lt;code&gt;View&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;这里我列举的并没有&lt;code&gt;inflate(int resource, ViewGroup root)&lt;/code&gt;这个重载方法，是因为他们最终都会到调用为&lt;code&gt;inflate(int resource, ViewGroup root, boolean attachToRoot)&lt;/code&gt;方法，如下：&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_2_263903&quot; name=&quot;code&quot; class=&quot;java&quot;&gt; public View inflate(int resource, ViewGroup root) {
        return inflate(resource, root, root != null);
 }

 public View inflate(int resource, ViewGroup root, boolean attachToRoot) {
        if (DEBUG) System.out.println(&amp;quot;INFLATING from resource: &amp;quot; + resource);
        XmlResourceParser parser = getContext().getResources().getLayout(resource);
        try {
            return inflate(parser, root, attachToRoot);
        } finally {
            parser.close();
        }
 }&lt;/pre&gt;

&lt;p&gt;这里要说明一下，其实最终要调用的是&lt;code&gt;inflate(XmlPullParser parser, ViewGroup root, boolean attachToRoot)&lt;/code&gt;方法，只不过这里把布局资源解析为了XmlPull解析器，这里就不针对&lt;code&gt;XmlPullParser&lt;/code&gt;进行研究了。&lt;/p&gt;
&lt;h2 id=&quot;针对传入的参数不同进行分析&quot;&gt;&lt;a href=&quot;#针对传入的参数不同进行分析&quot; class=&quot;headerlink&quot; title=&quot;针对传入的参数不同进行分析&quot;&gt;&lt;/a&gt;针对传入的参数不同进行分析&lt;/h2&gt;&lt;p&gt;通过对&lt;code&gt;inflate(XmlPullParser parser, ViewGroup root, boolean attachToRoot)&lt;/code&gt;方法的源码进行解读，&lt;code&gt;XmlPullParser parser&lt;/code&gt;是对传入&lt;code&gt;int resource&lt;/code&gt;的xml解析器，不用去主要考虑，那就需要考虑传入&lt;code&gt;ViewGroup root, boolean attachToRoot&lt;/code&gt;的&amp;#20540;不同，会出现什么结果呢？&lt;/p&gt;
&lt;p&gt;源码中有几个重要的代码块：&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_3_3719874&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;if (root != null) {
if (DEBUG) {
System.out.println(&amp;quot;Creating params from root: &amp;quot; +
                                    root);
}
// 如果root不等于null，获取它的LayoutParams
  params = root.generateLayoutParams(attrs);
if (!attachToRoot) {
//attachToRoot等于false，把root的LayoutParams属性给temp
temp.setLayoutParams(params);
}
}
&lt;/pre&gt;

&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_4_4700610&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;//attachToRoot等于true，将temp加入到root这个viewGroup中
if (root != null &amp;amp;&amp;amp; attachToRoot) {
root.addView(temp, params);
}

// root等于null，attachToRoot等于false，直接把temp赋值给返回结果
if (root == null || !attachToRoot) {
  result = temp;
}&lt;/pre&gt;

&lt;h2 id=&quot;根据不同的传-20540-进行实现&quot;&gt;&lt;a href=&quot;#根据不同的传-20540-进行实现&quot; class=&quot;headerlink&quot; title=&quot;根据不同的传&amp;#20540;进行实现&quot;&gt;&lt;/a&gt;根据不同的传&amp;#20540;进行实现&lt;/h2&gt;&lt;p&gt;两个布局文件，一个作为root，一个作为我们的要获取的view&lt;/p&gt;
&lt;p&gt;activity_my.xml&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_5_9900685&quot; name=&quot;code&quot; class=&quot;html&quot;&gt;&amp;lt;RelativeLayout xmlns:android=&amp;quot;http://schemas.android.com/apk/res/android&amp;quot;
    xmlns:tools=&amp;quot;http://schemas.android.com/tools&amp;quot;
    android:layout_width=&amp;quot;match_parent&amp;quot;
    android:layout_height=&amp;quot;match_parent&amp;quot;
    tools:context=&amp;quot;.MyActivity&amp;quot;&amp;gt;

    &amp;lt;TextView
        android:text=&amp;quot;@string/hello_world&amp;quot;
        android:layout_width=&amp;quot;wrap_content&amp;quot;
        android:layout_height=&amp;quot;wrap_content&amp;quot; /&amp;gt;

&amp;lt;/RelativeLayout&amp;gt;&lt;/pre&gt;

&lt;p&gt;view.xml&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_6_881422&quot; name=&quot;code&quot; class=&quot;html&quot;&gt;&amp;lt;LinearLayout xmlns:android=&amp;quot;http://schemas.android.com/apk/res/android&amp;quot;
    android:layout_width=&amp;quot;120dp&amp;quot;
    android:layout_height=&amp;quot;120dp&amp;quot;
    android:background=&amp;quot;@color/blue&amp;quot;&amp;gt;

    &amp;lt;TextView
        android:layout_width=&amp;quot;wrap_content&amp;quot;
        android:layout_height=&amp;quot;wrap_content&amp;quot;
        android:text=&amp;quot;hello inflate&amp;quot;
        android:textColor=&amp;quot;@android:color/white&amp;quot; /&amp;gt;

&amp;lt;/LinearLayout&amp;gt;&lt;/pre&gt;

&lt;p&gt;1,rootView等于null，attachToRoot等于false&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_7_1272731&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
    view = getLayoutInflater().inflate(R.layout.view, null, false);
    setContentView(view);
}&lt;/pre&gt;

&lt;p&gt;本身root为null，就不会去获取view的LayoutParams，直接走&lt;code&gt;result = temp;&lt;/code&gt;返回result，此时result等于view&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141024160656796?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;为什么会充满屏幕呢，因为当把view设置到activity的视图时，系统会取当前window的LayoutParm作为view的LayoutParm&lt;/p&gt;
&lt;p&gt;2,rootView等于null，attachToRoot等于true&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_8_9504448&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
    view = getLayoutInflater().inflate(R.layout.view, null, true);
    setContentView(view);
}&lt;/pre&gt;

&lt;p&gt;root等于null，依然走&lt;code&gt;result = temp;&lt;/code&gt;，此时result等于view&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141024160851796?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;为什么会充满屏幕呢，因为当把view设置到activity的视图时，系统会取当前window的LayoutParm作为view的LayoutParm&lt;/p&gt;
&lt;p&gt;3,rootView不等于null，attachToRoot等于false&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_9_1880625&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
rootView = getLayoutInflater().inflate(R.layout.activity_my, null);
    view = getLayoutInflater().inflate(R.layout.view,(ViewGroup)rootView,false);
    setContentView(view);
}&lt;/pre&gt;

&lt;p&gt;root不等于null，attachToRoot等于false，会走取view的LayoutParams并且赋&amp;#20540;给temp，再走&lt;code&gt;result = temp;&lt;/code&gt;，此时result等于view&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141024160912700?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;为什么会充满屏幕呢，因为当把view设置到activity的视图时，系统会取当前window的LayoutParm作为view的LayoutParm&lt;/p&gt;
&lt;p&gt;4,rootView不等于null，attachToRoot等于true&lt;/p&gt;
&lt;pre code_snippet_id=&quot;495633&quot; snippet_file_name=&quot;blog_20141024_10_3941156&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
rootView = getLayoutInflater().inflate(R.layout.activity_my, null);
    view = getLayoutInflater().inflate(R.layout.view,(ViewGroup)rootView,true);
    setContentView(view);
}&lt;/pre&gt;

&lt;p&gt;rootView不等于null，attachToRoot等于true，会首先获取view的Params，再走&lt;code&gt;root.addView(temp, params)&lt;/code&gt;，也就是，把view先放入的root这个ViewGroup中，再返回result，因为初始化的时候result就等于root，此时返回的就是包含有子View的root。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20141024160942932?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQva2VubmV0aHlv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;这里因为root的布局为RelativeLayout，我们把view加入到root中，view本身保留了自有的LayoutParm&lt;/p&gt;
&lt;p&gt;最后我要吐槽，为什么csdn不支持markdown，我都是先用Mou写好的，贴过来竟然要自己重新排版。。。&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2014/10/24 16:27:08 [原文链接](http://blog.csdn.net/kennethyo/article/details/40429031)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：1061 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/40429031#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;介绍常见inflate方法&quot;&gt;&lt;a href=&quot;#介绍常见inflate方法&quot; class=&quot;headerlink&quot; title=&quot;介绍常见inflate方法&quot;&gt;&lt;/a&gt;介绍常见inflate方法&lt;/h2&gt;&lt;p&gt;在日常开发中经常会用到通过资源id去获取view的场
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[原]Android API，版本对照</title>
    <link href="http://kennethyo.me/2014/08/22/2014-08-22/"/>
    <id>http://kennethyo.me/2014/08/22/2014-08-22/</id>
    <published>2014-08-22T02:51:53.000Z</published>
    <updated>2016-09-01T06:34:00.000Z</updated>
    
    <content type="html">&lt;div class=&quot;para&quot; style=&quot;font-family:Arial; font-size:14px; line-height:26px&quot;&gt;&lt;br&gt;&lt;br&gt;###&lt;br&gt;&lt;br&gt;### &lt;strong&gt;API等级1： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 1.0&amp;nbsp;&lt;br&gt;&lt;br&gt;API等级2： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 1.1 Petit Four &amp;nbsp;花式小蛋糕&lt;br&gt;&lt;br&gt;API等级3： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 1.5 Cupcake &amp;nbsp;纸杯蛋糕&lt;br&gt;&lt;br&gt;API等级4： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 1.6 Donut &amp;nbsp;甜甜圈&lt;br&gt;&lt;br&gt;API等级5： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 2.0 Éclair &amp;nbsp; 松饼&lt;br&gt;&lt;br&gt;API等级6： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 2.0.1 Éclair &amp;nbsp;松饼&lt;br&gt;&lt;br&gt;API等级7： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 2.1 Éclair &amp;nbsp; 松饼&lt;br&gt;&lt;br&gt;API等级8： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 2.2 - 2.2.3 Froyo &amp;nbsp;冻酸奶&lt;br&gt;&lt;br&gt;API等级9： &amp;nbsp;&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 2.3 - 2.3.2 Gingerbread &amp;nbsp;姜饼&lt;br&gt;&lt;br&gt;API等级10：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 2.3.3-2.3.7 Gingerbread &amp;nbsp; 姜饼&lt;br&gt;&lt;br&gt;API等级11：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 3.0 Honeycomb 蜂巢&lt;br&gt;&lt;br&gt;API等级12：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 3.1 Honeycomb 蜂巢&lt;br&gt;&lt;br&gt;API等级13：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 3.2 Honeycomb 蜂巢&lt;br&gt;&lt;br&gt;API等级14：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 4.0 - 4.0.2 Ice Cream Sandwich &amp;nbsp;冰激凌三明治&lt;br&gt;&lt;br&gt;API等级15：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 4.0.3 - 4.0.4 Ice Cream Sandwich &amp;nbsp;冰激凌三明治&lt;br&gt;&lt;br&gt;API等级16：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 4.1 Jelly Bean &amp;nbsp;糖豆&lt;br&gt;&lt;br&gt;API等级17：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 4.2 Jelly Bean &amp;nbsp;糖豆&lt;br&gt;&lt;br&gt;API等级18：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 4.3 Jelly Bean &amp;nbsp;糖豆&lt;br&gt;&lt;br&gt;API等级19：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android 4.4 KitKat &amp;nbsp;奇巧巧克力棒&lt;br&gt;&lt;br&gt;API等级20：&lt;span style=&quot;white-space:pre&quot;&gt; &lt;/span&gt;Android L&lt;/strong&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2014/8/22 10:51:53 [原文链接](http://blog.csdn.net/kennethyo/article/details/38752431)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：410 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/38752431#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;div class=&quot;para&quot; style=&quot;font-family:Arial; font-size:14px; line-height:26px&quot;&gt;&lt;br&gt;&lt;br&gt;###&lt;br&gt;&lt;br&gt;### &lt;strong&gt;API等级1： &amp;nbsp;&lt;span style=&quot;whit
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>[译]Android文本的测量和绘制</title>
    <link href="http://kennethyo.me/2014/06/23/20140623/"/>
    <id>http://kennethyo.me/2014/06/23/20140623/</id>
    <published>2014-06-23T03:20:50.000Z</published>
    <updated>2016-09-01T06:33:37.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;翻译与&lt;a href=&quot;http://chris.banes.me/#blog&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Chris Banes的博客&lt;/a&gt;&amp;nbsp; &amp;nbsp;&lt;a href=&quot;http://chris.banes.me/2014/03/27/measuring-text/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;原文地址&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;如果你想手动在Android Canvas上画些什么东西，你最好从绘制文本开始。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;文本绘制之前，你需要知道测量文本的绘制位置，计算文本X/Y轴的位置。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;u&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/u&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;最近我在一款APP中，需要在横向和纵向的画布上绘制一些以文本为中心的文字。于是我用了下面这些代码：&lt;/span&gt;&lt;/p&gt;
&lt;pre code_snippet_id=&quot;402800&quot; snippet_file_name=&quot;blog_20140623_1_1957768&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;Paint mTextPaint = new Paint();  
mTextPaint.setTextAlign(Paint.Align.CENTER); // Center the text

// Later when you draw...
canvas.drawText(mText, // Text to display  
        mBounds.centerX(), // Center X of canvas bounds
        mBounds.centerY(), // Center Y of canvas bounds
        mTextPaint
);&lt;/pre&gt;&lt;span style=&quot;font-size:18px&quot;&gt;

我没想到代码的运行后竟然是下面的这个样子：&lt;/span&gt;

![](http://chris.banes.me/content/images/2014/Mar/Screenshot_2014-03-27-14-41-58.png)

&lt;span style=&quot;font-size:32px&quot;&gt;测量文本&lt;/span&gt;

&lt;span style=&quot;font-size:18px&quot;&gt;

&lt;/span&gt;

&lt;span style=&quot;font-size:18px&quot;&gt;接下来，我尝试定位文本，计算了文本的高宽度，并且修改了绘制文本X轴Y轴的位置：&lt;/span&gt;

&lt;span style=&quot;font-size:18px&quot;&gt;

&lt;/span&gt;

&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;

&lt;pre code_snippet_id=&quot;402800&quot; snippet_file_name=&quot;blog_20140623_2_8130520&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;int mTextWidth, mTextHeight; // Our calculated text bounds  
Paint mTextPaint = new Paint();

// Now lets calculate the size of the text
Rect textBounds = new Rect();  
mTextPaint.getTextBounds(mText, 0, mText.length(), textBounds);  
mTextWidth = textBounds.width();  
mTextHeight = textBounds.height();

// Later when you draw...
canvas.drawText(mText, // Text to display  
        mBounds.centerX() - (mTextWidth / 2f),
        mBounds.centerY() + (mTextHeight / 2f),
        mTextPaint
);&lt;/pre&gt;

&lt;p&gt;这一次我们做的已经相当接近了，但是你可以看到文本还是没有居中。&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;img src=&quot;http://chris.banes.me/content/images/2014/Mar/Screenshot_2014-03-27-14-48-48.png&quot; alt=&quot;&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;为了确定我没看到的原因，我用Paint.getTextBounds()计算一个矩形，并画在了文本的后面。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;img src=&quot;http://chris.banes.me/content/images/2014/Mar/Screenshot_2014-03-27-14-50-33.png&quot; alt=&quot;&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;正如你看到的，文本的高宽绘制在了计算范围之外。&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:32px&quot;&gt;另一中测量文本的方法&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:24px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;在这个基础点上，我看到Paint另一种计算文本宽度的方法：Paint.measureText()&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;这个方法只能计算宽度而不能计算高度，因此我尝试结合两种方法：&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;pre code_snippet_id=&quot;402800&quot; snippet_file_name=&quot;blog_20140623_3_9003355&quot; name=&quot;code&quot; class=&quot;java&quot;&gt;int mTextWidth, mTextHeight; // Our calculated text bounds  
Paint mTextPaint = new Paint();

// Now lets calculate the size of the text
Rect textBounds = new Rect();  
mTextPaint.getTextBounds(mText, 0, mText.length(), textBounds);  
mTextWidth = mTextPaint.measureText(mText); // Use measureText to calculate width  
mTextHeight = textBounds.height(); // Use height from getTextBounds()

// Later when you draw...
canvas.drawText(mText, // Text to display  
        mBounds.centerX() - (mTextWidth / 2f),
        mBounds.centerY() + (mTextHeight / 2f),
        mTextPaint
);&lt;/pre&gt;

&lt;p&gt;这几下就做出了完美居中的文本。悠嘻！&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;&lt;img src=&quot;http://chris.banes.me/content/images/2014/Mar/perfect.png&quot; alt=&quot;&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;div&amp;gt;
    作者：zh08070005 发表于2014/6/23 11:20:50 [原文链接](http://blog.csdn.net/kennethyo/article/details/33720589)
&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
阅读：773 评论：0 [查看评论](http://blog.csdn.net/kennethyo/article/details/33720589#comments)
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;span style=&quot;font-size:18px&quot;&gt;翻译与&lt;a href=&quot;http://chris.banes.me/#blog&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Chris Banes的博客&lt;/a&gt;&amp;nbsp; &amp;nbsp;&lt;a hr
    
    </summary>
    
      <category term="Android" scheme="http://kennethyo.me/categories/Android/"/>
    
    
      <category term="Android" scheme="http://kennethyo.me/tags/Android/"/>
    
  </entry>
  
</feed>
